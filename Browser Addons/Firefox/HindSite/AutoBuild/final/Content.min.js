/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/_first/_ContentManagerBase.js
class ContentManagerBase {
    constructor(contentHub, allContentAgents) {
        this.ContentHub = contentHub;
        this.ContentAgents = allContentAgents;
    }
    AtticMan() { return this.ContentHub.AtticMan; }
    Helpers() { return this.ContentHub.Helpers; }
    OneScWinMan() { return this.ContentHub.OneWindowMan; }
    ScUiMan() { return this.ContentHub.SitecoreUiMan; }
    MsgMan() { return this.ContentHub.MsgMan; }
    ContentFactory() { return this.ContentHub.ContentFactory; }
    MiscMan() { return this.ContentHub.MiscMan; }
    PromiseOneStep() { return this.ContentHub.PromiseOneStep; }
    MsgFlag() { return this.ContentHub.MessageFlag; }
    SharedConst() { return this.ContentHub.SharedConst; }
    ReadyForMessages() { return this.ContentHub.ReadyForMessages; }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/scWindowType.js
var scWindowType;
(function (scWindowType) {
    scWindowType[scWindowType["Unknown"] = 0] = "Unknown";
    scWindowType[scWindowType["LoginPage"] = 1] = "LoginPage";
    scWindowType[scWindowType["Desktop"] = 2] = "Desktop";
    scWindowType[scWindowType["ContentEditor"] = 3] = "ContentEditor";
    scWindowType[scWindowType["Launchpad"] = 4] = "Launchpad";
    scWindowType[scWindowType["Edit"] = 5] = "Edit";
    scWindowType[scWindowType["Normal"] = 6] = "Normal";
    scWindowType[scWindowType["Preview"] = 7] = "Preview";
})(scWindowType || (scWindowType = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/SnapShotFlavor.js
var SnapShotFlavor;
(function (SnapShotFlavor) {
    SnapShotFlavor[SnapShotFlavor["Unknown"] = 0] = "Unknown";
    SnapShotFlavor[SnapShotFlavor["Autosave"] = 1] = "Autosave";
    SnapShotFlavor[SnapShotFlavor["Favorite"] = 2] = "Favorite";
    SnapShotFlavor[SnapShotFlavor["Manual"] = 3] = "Manual";
})(SnapShotFlavor || (SnapShotFlavor = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/PromiseResult.js
class PromiseResult {
    constructor(nickname, logger) {
        this.prefix = 'Promise Successful? -> ';
        this.Success = false;
        this.NickName = nickname;
        this.RejectReasonArPvt = [];
        this.Log = logger;
    }
    WasSuccessful() {
        return this.Success;
    }
    MarkSuccessful() {
        this.Success = true;
        if (this.Log) {
            this.Log.LogVal(this.prefix + this.NickName, this.Success);
        }
        else {
            console.log('no logger success');
        }
    }
    MarkFailed(ex) {
        if (ex) {
            ex = ex.toString();
        }
        else {
            ex = '{no fail message}';
        }
        this.RejectReasons += ', ' + ex;
        this.Success = false;
        if (this.Log) {
            this.Log.Error(this.prefix + this.NickName, this.Success + '  err: ' + ex);
        }
        else {
            console.log('no logger fail ' + ex);
        }
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/CacheMode.js
var CacheMode;
(function (CacheMode) {
    CacheMode[CacheMode["DoNotUseCach"] = 0] = "DoNotUseCach";
    CacheMode[CacheMode["OkToUseCache"] = 1] = "OkToUseCache";
})(CacheMode || (CacheMode = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/MessageFlag.js
var MsgFlag;
(function (MsgFlag) {
    MsgFlag[MsgFlag["Unknown"] = 0] = "Unknown";
    MsgFlag[MsgFlag["GetAllStorageOneWindow"] = 1] = "GetAllStorageOneWindow";
    MsgFlag[MsgFlag["NewWindowTest"] = 2] = "NewWindowTest";
    MsgFlag[MsgFlag["RemoveFromStorage"] = 3] = "RemoveFromStorage";
    MsgFlag[MsgFlag["ReqAddCETab"] = 4] = "ReqAddCETab";
    MsgFlag[MsgFlag["ReqAdminB"] = 5] = "ReqAdminB";
    MsgFlag[MsgFlag["ReqCurState"] = 6] = "ReqCurState";
    MsgFlag[MsgFlag["ReqGoDesktop"] = 7] = "ReqGoDesktop";
    MsgFlag[MsgFlag["ReqLoginWithAdminB"] = 8] = "ReqLoginWithAdminB";
    MsgFlag[MsgFlag["ReqOpenCE"] = 9] = "ReqOpenCE";
    MsgFlag[MsgFlag["ReqQuickPublish"] = 10] = "ReqQuickPublish";
    MsgFlag[MsgFlag["ReqRestoreClick"] = 11] = "ReqRestoreClick";
    MsgFlag[MsgFlag["ReqRestoreToNewTab"] = 12] = "ReqRestoreToNewTab";
    MsgFlag[MsgFlag["ReqSetScMode"] = 13] = "ReqSetScMode";
    MsgFlag[MsgFlag["ReqTakeSnapShot"] = 14] = "ReqTakeSnapShot";
    MsgFlag[MsgFlag["ReqUpdateNickName"] = 15] = "ReqUpdateNickName";
    MsgFlag[MsgFlag["RespCurState"] = 16] = "RespCurState";
    MsgFlag[MsgFlag["RespError"] = 17] = "RespError";
    MsgFlag[MsgFlag["RespTaskFailed"] = 18] = "RespTaskFailed";
    MsgFlag[MsgFlag["RespTaskSuccessful"] = 19] = "RespTaskSuccessful";
    MsgFlag[MsgFlag["RespTest"] = 20] = "RespTest";
    MsgFlag[MsgFlag["ReqMarkFavorite"] = 21] = "ReqMarkFavorite";
    MsgFlag[MsgFlag["Ping"] = 22] = "Ping";
    MsgFlag[MsgFlag["RespListeningAndReady"] = 23] = "RespListeningAndReady";
})(MsgFlag || (MsgFlag = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/BufferDirection.js
var BufferDirection;
(function (BufferDirection) {
    BufferDirection[BufferDirection["left"] = 0] = "left";
    BufferDirection[BufferDirection["right"] = 1] = "right";
})(BufferDirection || (BufferDirection = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/BufferChar.js
var BufferChar;
(function (BufferChar) {
    BufferChar[BufferChar["space"] = 0] = "space";
    BufferChar[BufferChar["Nbsp"] = 1] = "Nbsp";
    BufferChar[BufferChar["Period"] = 2] = "Period";
    BufferChar[BufferChar["Zero"] = 3] = "Zero";
})(BufferChar || (BufferChar = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/SettingKey.js
var SettingKey;
(function (SettingKey) {
    SettingKey[SettingKey["unknown"] = 0] = "unknown";
    SettingKey[SettingKey["AutoLogin"] = 100] = "AutoLogin";
    SettingKey[SettingKey["__dead101"] = 101] = "__dead101";
    SettingKey[SettingKey["DebugKeepDialogOpen"] = 102] = "DebugKeepDialogOpen";
    SettingKey[SettingKey["AutoSaveIntervalMin"] = 103] = "AutoSaveIntervalMin";
    SettingKey[SettingKey["MaxAutoSaveCount"] = 200] = "MaxAutoSaveCount";
    SettingKey[SettingKey["LogToConsole"] = 201] = "LogToConsole";
    SettingKey[SettingKey["Test"] = 202] = "Test";
    SettingKey[SettingKey["LgndLog"] = 300] = "LgndLog";
    SettingKey[SettingKey["LgndForeSite"] = 301] = "LgndForeSite";
    SettingKey[SettingKey["LgndHindSite"] = 302] = "LgndHindSite";
    SettingKey[SettingKey["LgndSettings"] = 303] = "LgndSettings";
    SettingKey[SettingKey["LgndState"] = 304] = "LgndState";
    SettingKey[SettingKey["NotUsed"] = 305] = "NotUsed";
    SettingKey[SettingKey["AutoSnapshotBeforeWindowChange"] = 306] = "AutoSnapshotBeforeWindowChange";
})(SettingKey || (SettingKey = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/StaticHelpers.js







class StaticHelpers_StaticHelpers {
    static MinToMs(minutes) {
        return minutes * 60 * 1000;
    }
    static FlavorAsString(flavor) {
        return 'Flavor.' + SnapShotFlavor[flavor] + '(' + flavor + ')';
    }
    static SettingKeyAsString(settingKey) {
        return 'SettingKey.' + SettingKey[settingKey] + '(' + settingKey + ')';
    }
    static CacheModeAsString(cacheMode) {
        return 'CacheMode.' + CacheMode[cacheMode] + ' (' + cacheMode + ')';
    }
    static WindowTypeAsString(windowType) {
        return scWindowType[windowType];
    }
    static BufferString(str, desiredLength, buffCharEnum, direction) {
        var toReturn = str;
        var buffChar = ' ';
        if (buffCharEnum === BufferChar.space) {
            buffChar = ' ';
        }
        else if (buffCharEnum === BufferChar.Nbsp) {
            buffChar = '&nbsp;';
        }
        else if (buffCharEnum === BufferChar.Period) {
            buffChar = '.';
        }
        else if (buffCharEnum === BufferChar.Zero) {
            buffChar = '0';
        }
        if (toReturn.length > desiredLength) {
            if (desiredLength > 6) {
                toReturn = toReturn.substring(0, desiredLength - 3) + '...';
            }
            else {
                toReturn = toReturn.substring(0, desiredLength);
            }
        }
        if (toReturn.length < desiredLength) {
            var bufferCharNeeded = desiredLength - toReturn.length;
            for (var idx = 0; idx < bufferCharNeeded; idx++) {
                if (direction === BufferDirection.left) {
                    toReturn = buffChar + toReturn;
                }
                else {
                    toReturn = toReturn + buffChar;
                }
            }
        }
        return toReturn;
    }
    static MsgFlagAsString(msg) {
        var toReturn = "{error}";
        if (msg) {
            try {
                toReturn = 'MsgFlag.' + MsgFlag[msg] + '(' + msg + ')';
            }
            catch (e) {
            }
        }
        return 'flag: ' + toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Enums/scMode.js
var scMode_scMode;
(function (scMode) {
    scMode[scMode["Unknown"] = 0] = "Unknown";
    scMode[scMode["Edit"] = 1] = "Edit";
    scMode[scMode["Preview"] = 2] = "Preview";
    scMode[scMode["Normal"] = 3] = "Normal";
})(scMode_scMode || (scMode_scMode = {}));

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Interfaces/InjectConst.js

let InjectConst_ContentConst = (() => {
    class ContentConst {
    }
    ContentConst.Const = {
        MaxAutoToSaveCount: 10,
        MaxAutoSaveAgeDays: 1,
        MaxCacheAgeMs: 1000 * 60 * 10,
        Iterations: {
            MaxSetHrefEffort: 10,
            MaxIterationSwitchBoard: 20,
        },
        Timeouts: {
            PostLoginBtnClick: 1000,
            SetHrefEffortWait: 1000,
            WaitBeforeRemovingCompleteFlagOnContent: 1500,
            AutoSaveIntervalMin: 1,
        },
        ElemId: {
            sc: {
                scLoginUserName: 'UserName',
                scLoginPassword: 'Password',
                SitecoreRootNodeId: 'Tree_Node_11111111111111111111111111111111',
                SitecoreRootGlyphId: 'Tree_Glyph_11111111111111111111111111111111',
                scLoginBtn: {
                    sc920: 'LogInBtn',
                    sc820: null
                },
            }
        },
        ClassNames: {
            ContentTreeNode: 'scContentTreeNode',
            SC: {
                scContentTreeNodeActive: 'scContentTreeNodeActive',
            }
        },
        ScMode: {
            edit: { AsEnum: scMode_scMode.Edit, AsString: 'edit' },
            normal: { AsEnum: scMode_scMode.Normal, AsString: 'normal' },
            preview: { AsEnum: scMode_scMode.Preview, AsString: 'preview' },
        },
        Selector: {
            SC: {
                ContentTreeNodeGlyph: '.scContentTreeNodeGlyph',
                IdStartsWithTreeNode: '[id^=Tree_Node_]',
                IframeContent: {
                    sc820: null,
                    sc920: 'iframe[src*=Content]'
                },
                JqueryModalDialogsFrame: '[id=jqueryModalDialogsFrame]',
                ContentIframe0: '[id=scContentIframeId0]',
                NextButton: '[id=NextButton]',
                ContentIFrame1: '[id=scContentIframeId1]',
                Ok: '[id=OK]',
                Cancel: '[id=CancelButton]',
                MenuButtonPublish: '[id=B414550BADAF4542C9ADF44BED5FA6CB3E_menu_button]',
                MenuDropDownPublishItem: '[id=B414550BADAF4542C9ADF44BED5FA6CB3E_menu_98719A90225A4802A0625D3967E4DD47]',
                NavPublishStrip: '[id*=_Nav_PublishStrip]',
                StartMenuLeftOption: '.scStartMenuLeftOption',
                Publish: {
                    TheItemHasBeenPublished: '[id=LastPage]:not([style*=\'display:none\'])',
                    SettingsHidden: '[id=Settings][style*=\'display: none\']',
                    PublishingHidden: '[id=Publishing][style*=\'display: none\']',
                },
                LoginBtn: {
                    sc920: null,
                    sc820: 'input.btn',
                },
                scStartButton: {
                    sc920: '[id=StartButton]',
                    sc820: '[id=startButton]'
                },
            },
        },
        Storage: {
            SettingsSuffix: '.Settings',
            ShowDebugData: false,
            SnapShotPrefix: '.WindowSnapShot.',
            WindowRoot: 'Xyyz',
        },
        MaxIter: 100,
        MaxNullOrUndefinedIter: 100,
        prop: {
            AllTreeData: 'AllTreeData',
        },
        Names: {
            SC: {
                TreeGlyphPrefix: 'Tree_Glyph_',
                TreeNodePrefix: 'Tree_Node_',
                TreeExpandedPng: {
                    sc920: 'treemenu_expanded.png',
                    sc820: 'todo'
                }
            },
            PopUp: 'PopUp',
            PopUpStyles: 'PopUpStyles',
            TreeMenuExpandedPng: 'treemenu_expanded.png',
            TreeMenuCollapsedPng: 'treemenu_collapsed.png',
            scDefaultAdminPassword: 'b',
            scDefaultAdminUserName: 'admin',
        }
    };
    return ContentConst;
})();


// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/ContentAtticManager.js
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







class ContentAtticManager_ContentAtticManager extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(ContentAtticManager_ContentAtticManager.name);
        this.ContentAgents.Logger.FuncEnd(ContentAtticManager_ContentAtticManager.name);
    }
    Init() {
    }
    UpdateNickname(payload) {
        return new Promise((resolve, reject) => {
            this.ContentAgents.Logger.FuncStart(this.UpdateNickname.name);
            var promResult = new PromiseResult(this.UpdateNickname.name, this.ContentAgents.Logger);
            if (payload.IdOfSelect) {
                var storageMatch = this.GetFromStorageById(payload.IdOfSelect, CacheMode.OkToUseCache);
                if (storageMatch && payload.SnapShotSettings && payload.SnapShotSettings.SnapShotNewNickname) {
                    storageMatch.NickName = payload.SnapShotSettings.SnapShotNewNickname;
                    this.WriteToStorage(storageMatch);
                    promResult.MarkSuccessful();
                }
                else {
                    promResult.MarkFailed('something was missing');
                }
            }
            else {
                promResult.MarkFailed('no payload or id');
                this.ContentAgents.Logger.LogAsJsonPretty(this.UpdateNickname.name, payload);
            }
            this.ContentAgents.Logger.FuncEnd(this.UpdateNickname);
            if (promResult.WasSuccessful()) {
                resolve();
            }
            else {
                reject(promResult.RejectReasons);
            }
        });
    }
    MarkFavorite(data) {
        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.MarkFavorite.name);
            var result = new PromiseResult(this.MarkFavorite.name, this.ContentAgents.Logger);
            if (data.IdOfSelect) {
                var storageMatch = this.GetFromStorageById(data.IdOfSelect, CacheMode.OkToUseCache);
                if (storageMatch) {
                    storageMatch.Flavor = SnapShotFlavor.Favorite;
                    yield this.WriteToStorage(storageMatch);
                    result.MarkSuccessful();
                }
                else {
                    result.MarkFailed('no storage match');
                }
            }
            else {
                result.MarkFailed('no data.idofselect');
            }
            this.ContentAgents.Logger.FuncEnd(this.MarkFavorite.name);
            if (result) {
                resolve();
            }
            else {
                reject(result.RejectReasons);
            }
        }));
    }
    WriteToStorage(dataOneWindow) {
        return __awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {
                this.ContentAgents.Logger.FuncStart(this.WriteToStorage.name);
                var result = new PromiseResult(this.WriteToStorage.name, this.ContentAgents.Logger);
                var snapShotAsString = JSON.stringify(dataOneWindow);
                yield window.localStorage.setItem(InjectConst_ContentConst.Const.Storage.WindowRoot + InjectConst_ContentConst.Const.Storage.SnapShotPrefix + dataOneWindow.Id.AsString, snapShotAsString);
                var foundInStorage = yield this.GetFromStorageById(dataOneWindow.Id, CacheMode.DoNotUseCach);
                if (foundInStorage) {
                    result.MarkSuccessful();
                }
                else {
                    result.MarkFailed('not found in storage');
                    result.MarkFailed('Snap shot not successfully saved');
                }
                this.ContentAgents.Logger.FuncEnd(this.WriteToStorage.name);
                if (result.WasSuccessful()) {
                    resolve();
                }
                else {
                    reject(result.RejectReasons);
                }
            }));
        });
    }
    GetFromStorageById(needleId, cacheMode) {
        this.ContentAgents.Logger.FuncStart(this.GetFromStorageById.name, needleId.AsString);
        var foundStorage = this.GetAllSnapShotsMany(cacheMode);
        var DateOneWinStoreMatch = null;
        if (foundStorage) {
            for (var idx = 0; idx < foundStorage.CurrentSnapShots.length; idx++) {
                var candidate = foundStorage.CurrentSnapShots[idx];
                if (candidate.Id.AsString === needleId.AsString) {
                    DateOneWinStoreMatch = candidate;
                    break;
                }
            }
        }
        if (DateOneWinStoreMatch) {
            this.ContentAgents.Logger.Log('found match', this.Helpers().UtilityHelp.TimeNicknameFavStr(DateOneWinStoreMatch));
        }
        else {
            this.ContentAgents.Logger.LogVal(this.GetFromStorageById.name, 'Match notfound');
        }
        this.ContentAgents.Logger.FuncEnd(this.GetFromStorageById.name);
        return DateOneWinStoreMatch;
    }
    __getAllLocalStorageAsIOneStorageData() {
        this.ContentAgents.Logger.FuncStart(this.__getAllLocalStorageAsIOneStorageData.name);
        var toReturn = [];
        var storageLength = window.localStorage.length;
        this.ContentAgents.Logger.LogVal('storageLength', storageLength);
        for (var idx = 0; idx < storageLength; idx++) {
            this.ContentAgents.Logger.LogVal('Processing Index', idx);
            var candidate = {
                data: '',
                key: '',
            };
            candidate.key = window.localStorage.key(idx);
            this.ContentAgents.Logger.LogVal('Candidate.key', candidate.key);
            if (candidate.key.startsWith(InjectConst_ContentConst.Const.Storage.WindowRoot + InjectConst_ContentConst.Const.Storage.SnapShotPrefix)) {
                this.ContentAgents.Logger.LogVal('valid candidate', true);
                candidate.data = window.localStorage.getItem(candidate.key);
                if (this.ContentAgents.Logger.IsNotNullOrUndefinedBool('candidate.data', candidate.data)) {
                    toReturn.push(candidate);
                }
            }
        }
        this.ContentAgents.Logger.FuncEnd(this.__getAllLocalStorageAsIOneStorageData.name, toReturn.length);
        return toReturn;
    }
    __parseRawData(oneRaw) {
        var candidate = JSON.parse(oneRaw.data);
        console.log;
        if (candidate) {
            candidate.TimeStamp = new Date(candidate.TimeStamp);
            candidate.Id = this.ContentHub.Helpers.GuidHelp.ParseGuid(candidate.Id.AsString);
            candidate.RawData = oneRaw;
            if (!candidate.WindowType) {
                candidate.WindowType = scWindowType.Unknown;
                candidate.WindowFriendly = scWindowType[candidate.WindowType];
            }
            if (!candidate.NickName) {
                candidate.NickName = '';
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.__parseRawData.name, 'Saved data did not import correctly');
        }
        return candidate;
    }
    __getAllStorageReal() {
        this.ContentAgents.Logger.FuncStart(this.__getAllStorageReal.name);
        var toReturn = [];
        var rawStorageData = this.__getAllLocalStorageAsIOneStorageData();
        if (rawStorageData) {
            for (var idx = 0; idx < rawStorageData.length; idx++) {
                toReturn.push(this.__parseRawData(rawStorageData[idx]));
            }
        }
        toReturn.sort((a, b) => +b.TimeStamp - +a.TimeStamp);
        toReturn = this.FilterOutOldData(toReturn);
        this.ContentAgents.Logger.FuncEnd(this.__getAllStorageReal.name);
        return toReturn;
    }
    CleanOutOldData() {
        this.ContentAgents.Logger.FuncStart(this.CleanOutOldData.name);
        var cleanData = [];
        var now = new Date();
        var maxAutoSaveDiff = InjectConst_ContentConst.Const.MaxAutoSaveAgeDays * 24 * 60 * 60 * 1000;
        if (this.CachedWindowStorage) {
            var cacheLength = this.CachedWindowStorage.CurrentSnapShots.length;
            var autoCount = 0;
            for (var idx = 0; idx < cacheLength; idx++) {
                var deleteFlag = false;
                var candidate = this.CachedWindowStorage.CurrentSnapShots[idx];
                if (candidate.Flavor) {
                    if (autoCount > InjectConst_ContentConst.Const.MaxAutoToSaveCount) {
                        this.ContentAgents.Logger.LogVal('Delete (max count :' + InjectConst_ContentConst.Const.MaxAutoToSaveCount + ')', candidate.TimeStamp.toString());
                        deleteFlag = true;
                    }
                    autoCount++;
                }
                if (now.getTime() - candidate.TimeStamp.getTime() > maxAutoSaveDiff) {
                    this.ContentAgents.Logger.LogVal('Delete (Old : max' + InjectConst_ContentConst.Const.MaxAutoSaveAgeDays + ' days)', candidate.TimeStamp.toString());
                    deleteFlag = true;
                }
                if (!deleteFlag) {
                    cleanData.push(candidate);
                }
                else {
                    try {
                        this.ContentAgents.Logger.LogVal('Cleaning old autosave', candidate.RawData.key);
                        window.localStorage.removeItem(candidate.RawData.key);
                    }
                    catch (e) {
                        this.ContentAgents.Logger.Error(this.CleanOutOldData.name, 'unable to delete key: ' + candidate.RawData.key);
                    }
                }
            }
            this.CachedWindowStorage.CurrentSnapShots = cleanData;
        }
        this.ContentAgents.Logger.FuncEnd(this.CleanOutOldData.name);
    }
    GetAllSnapShotsMany(cacheMode) {
        this.ContentAgents.Logger.FuncStart(this.GetAllSnapShotsMany.name, StaticHelpers_StaticHelpers.CacheModeAsString(cacheMode));
        var toReturn;
        if (cacheMode === CacheMode.DoNotUseCach) {
            this.CachedWindowStorage = null;
        }
        if (!this.CachedWindowStorage) {
            this.CachedWindowStorage = {
                CurrentSnapShots: [],
                Birthday: new Date(1970),
                FavoriteCount: 0,
                SnapShotsAutoCount: 0,
                PlainCount: 0,
            };
        }
        var timeDiff = Date.now() - this.CachedWindowStorage.Birthday.getTime();
        this.ContentAgents.Logger.LogVal('cached timeDiff', timeDiff + ' : ' + InjectConst_ContentConst.Const.MaxCacheAgeMs);
        if (timeDiff > (InjectConst_ContentConst.Const.MaxCacheAgeMs)) {
            this.ContentAgents.Logger.Log('updating cache');
            this.CachedWindowStorage.CurrentSnapShots = this.__getAllStorageReal();
            this.CachedWindowStorage.Birthday = new Date();
        }
        else {
            this.ContentAgents.Logger.Log('using cache');
        }
        this.CleanOutOldData();
        this.UpdateCounts();
        toReturn = this.CachedWindowStorage;
        this.ContentAgents.Logger.FuncEnd(this.GetAllSnapShotsMany.name);
        return toReturn;
    }
    UpdateCounts() {
        this.CachedWindowStorage.FavoriteCount = 0;
        this.CachedWindowStorage.SnapShotsAutoCount = 0;
        this.CachedWindowStorage.PlainCount = 0;
        for (var idx = 0; idx < this.CachedWindowStorage.CurrentSnapShots.length; idx++) {
            var candidate = this.CachedWindowStorage.CurrentSnapShots[idx];
            if (candidate.Flavor === SnapShotFlavor.Autosave) {
                this.CachedWindowStorage.SnapShotsAutoCount++;
            }
            else if (candidate.Flavor === SnapShotFlavor.Favorite) {
                this.CachedWindowStorage.FavoriteCount++;
            }
            else {
                this.CachedWindowStorage.PlainCount++;
            }
        }
    }
    FilterOutOldData(data) {
        var toReturn = data;
        return toReturn;
    }
    RemoveOneFromStorage(targetId) {
        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RemoveOneFromStorage.name);
            var successful = true;
            var failMsg = '';
            try {
                if (targetId) {
                    var storageMatch = yield this.GetFromStorageById(targetId, CacheMode.OkToUseCache);
                    if (storageMatch) {
                        var result = confirm('Remove ?: ' + this.ContentHub.Utilities.TimeNicknameFavStrForConfirmation(storageMatch));
                        if (result === true) {
                            this.ContentAgents.Logger.LogVal('Key to Delete', storageMatch.RawData.key);
                            yield window.localStorage.removeItem(storageMatch.RawData.key);
                            var stillExists = yield this.GetFromStorageById(targetId, CacheMode.DoNotUseCach);
                            if (stillExists) {
                                successful = false;
                                failMsg = 'Snapshot still exists after deleting';
                            }
                            else {
                                successful = true;
                            }
                            this.ContentAgents.Logger.Log('Attempting completed');
                        }
                        else {
                            successful = false;
                            failMsg = 'Confirmation not received';
                        }
                    }
                    else {
                        successful = false;
                        failMsg = 'no storage match';
                    }
                }
                else {
                    successful = false;
                    failMsg = 'no target id';
                }
            }
            catch (e) {
                successful = false;
                failMsg = e.toString();
            }
            this.ContentAgents.Logger.FuncEnd(this.RemoveOneFromStorage.name);
            if (successful) {
                this.ContentAgents.Logger.Log('resolving');
                resolve();
            }
            else {
                this.ContentAgents.Logger.Log('rejecting');
                reject(failMsg);
            }
        }));
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/MiscManager.js


class MiscManager_MiscManager extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(MiscManager_MiscManager.name);
        this.ContentAgents.Logger.FuncEnd(MiscManager_MiscManager.name);
    }
    NotNullOrUndefined(subjectAnyOrAr, label = '', iterationCheck = null) {
        var toReturn = false;
        if (!iterationCheck) {
            iterationCheck = InjectConst_ContentConst.Const.MaxNullOrUndefinedIter;
        }
        iterationCheck -= 1;
        if (iterationCheck > 0) {
            if (label === '') {
                label = this.NotNullOrUndefined.name + ' : no labelprovided';
            }
            if (subjectAnyOrAr === 'undefined') {
                this.ContentAgents.Logger.Error(label, 'Is undefined');
            }
            else if (!subjectAnyOrAr) {
                this.ContentAgents.Logger.Error(label, 'Is Null');
            }
            else {
                this.ContentAgents.Logger.LogVal(label, 'Passed');
                toReturn = true;
                if (Array.isArray(subjectAnyOrAr)) {
                    for (var idx = 0; idx < subjectAnyOrAr.length; idx++) {
                        toReturn = toReturn && this.NotNullOrUndefined(subjectAnyOrAr[idx], (idx + 1) + ':' + subjectAnyOrAr.length + ' ' + label, iterationCheck);
                    }
                }
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.NotNullOrUndefined.name, 'max iteration hit');
        }
        this.ContentAgents.Logger.LogVal('toReturn', toReturn);
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Promises/PromiseChainQuickPublish.js
var PromiseChainQuickPublish_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class PromiseChainQuickPublish_PromiseChainQuickPublish extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
    }
    __debugDataPublishChain(dataPublishChain, nickname) {
        this.ContentAgents.Logger.FuncStart(this.__debugDataPublishChain.name, nickname);
        this.ContentAgents.Logger.LogVal('docToPublish', this.ContentAgents.Logger.IsNullOrUndefined(dataPublishChain.docToPublish));
        this.ContentAgents.Logger.LogVal('jqIframe', this.ContentAgents.Logger.IsNullOrUndefined(dataPublishChain.jqIframe) + ' ' + (dataPublishChain.jqIframe ? dataPublishChain.jqIframe.IframeElem.src : ''));
        this.ContentAgents.Logger.LogVal('Iframe0blueIframe', this.ContentAgents.Logger.IsNullOrUndefined(dataPublishChain.Iframe0Blue) + ' ' + (dataPublishChain.Iframe0Blue ? dataPublishChain.Iframe0Blue.IframeElem.src : ''));
        this.ContentAgents.Logger.LogVal('messageDialogIframeRed', this.ContentAgents.Logger.IsNullOrUndefined(dataPublishChain.messageDialogIframeRed) + ' ' + (dataPublishChain.messageDialogIframeRed ? dataPublishChain.messageDialogIframeRed.IframeElem.src : ''));
        this.ContentAgents.Logger.FuncEnd(this.__debugDataPublishChain.name);
        return dataPublishChain;
    }
    PublishCE(docToPublish) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.PublishCE.name);
            var dataPublishChain = {
                docToPublish: docToPublish,
                TopLevelDoc: this.ScUiMan().TopLevelDoc(),
                Iframe0Blue: null,
                jqIframe: null,
                messageDialogIframeRed: null
            };
            yield this.PromiseOneStep().ClickPublishOnNav(dataPublishChain)
                .then((dataPublishChain) => this.PromiseOneStep().ClickMenuButtonPublishDropDown(dataPublishChain))
                .then((dataPublishChain) => this.PromiseOneStep().ClickMenuDropDownPublishItem(dataPublishChain))
                .then((dataPublishChain) => this.PromiseOneStep().GetThePublishItemDialog(dataPublishChain))
                .then((dataPublishChain) => this.GetDialogIframe0Blue(dataPublishChain))
                .then((dataPublishChain) => this.__WaitForAndClickPublishNextButton(dataPublishChain))
                .then((dataPublishChain) => this.GetMessageDialog(dataPublishChain))
                .then((dataPublishChain) => this.__waitForAndClickOk(dataPublishChain))
                .then((dataPublishChain) => this.__waitForAndClickClose(dataPublishChain))
                .catch(ex => {
                this.ContentAgents.Logger.Error(this.PublishCE.name, ex);
            });
            this.ContentAgents.Logger.FuncEnd(this.PublishCE.name);
        });
    }
    __waitForAndClickClose(dataPublishChain) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForAndReturnFoundElem(dataPublishChain.Iframe0Blue.ContentDoc, InjectConst_ContentConst.Const.Selector.SC.Publish.SettingsHidden)
                .then(() => PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
                yield this.Helpers().PromiseHelp.WaitForAndReturnFoundElem(dataPublishChain.Iframe0Blue.ContentDoc, InjectConst_ContentConst.Const.Selector.SC.Publish.TheItemHasBeenPublished, this.SharedConst().IterHelper.MaxCount.OverridePublishing);
            }))
                .then(() => PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
                yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.Cancel], dataPublishChain.Iframe0Blue.ContentDoc);
            }));
            return dataPublishChain;
        });
    }
    __waitForAndClickOk(dataPublishChain) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.Ok], dataPublishChain.messageDialogIframeRed.ContentDoc);
            return dataPublishChain;
        });
    }
    __WaitForAndClickPublishNextButton(dataPublishChain) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.NextButton], dataPublishChain.Iframe0Blue.ContentDoc);
            return dataPublishChain;
        });
    }
    GetMessageDialog(dataPublishChain) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            let toReturnPublishChain = dataPublishChain;
            yield this.Helpers().PromiseHelp.WaitForIframeElemAndReturnWhenReady(dataPublishChain.jqIframe.ContentDoc, InjectConst_ContentConst.Const.Selector.SC.ContentIFrame1, 'iframeRed')
                .then((result) => toReturnPublishChain.messageDialogIframeRed = result)
                .catch((err) => this.ContentAgents.Logger.Error(this.GetMessageDialog, err));
            return toReturnPublishChain;
        });
    }
    GetDialogIframe0Blue(dataPublishChain = null) {
        return PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
                this.ContentAgents.Logger.FuncStart(this.GetDialogIframe0Blue.name);
                let promiseResult = new PromiseResult(this.GetDialogIframe0Blue.name, this.ContentAgents.Logger);
                this.ContentAgents.Logger.LogAsJsonPretty('dataPublishChain', dataPublishChain);
                yield this.Helpers().PromiseHelp.WaitForIframeElemAndReturnWhenReady(dataPublishChain.jqIframe.ContentDoc, InjectConst_ContentConst.Const.Selector.SC.ContentIframe0, 'Iframe0Blue')
                    .then((result) => {
                    this.ContentAgents.Logger.MarkerC();
                    dataPublishChain.Iframe0Blue = result;
                    promiseResult.MarkSuccessful();
                })
                    .catch((err) => promiseResult.MarkFailed(err));
                this.ContentAgents.Logger.LogAsJsonPretty('dataPublishChain.Iframe0Blue', dataPublishChain.Iframe0Blue);
                this.ContentAgents.Logger.FuncEnd(this.GetDialogIframe0Blue.name);
                if (promiseResult.WasSuccessful()) {
                    resolve(dataPublishChain);
                }
                else {
                    reject(promiseResult.RejectReasons);
                }
            }));
        });
    }
    __waitForThenFunc(selector, targetDoc, dataPublishChain, optionFunc) {
        return new Promise((resolve, reject) => PromiseChainQuickPublish_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.__waitForThenFunc.name, selector);
            this.ContentAgents.Logger.DebugIDataOneDoc(targetDoc);
            var found = null;
            var found = yield this.Helpers().PromiseHelp.WaitForAndReturnFoundElem(targetDoc, selector);
            if (found) {
                this.ContentAgents.Logger.Log('found');
                if (optionFunc) {
                    this.ContentAgents.Logger.Log('executing func');
                    dataPublishChain = yield optionFunc(found, dataPublishChain);
                }
                this.__debugDataPublishChain(dataPublishChain, this.__waitForThenFunc.name);
                this.ContentAgents.Logger.FuncEnd(this.__waitForThenFunc.name, selector);
                resolve(dataPublishChain);
            }
            else {
                reject('not found');
            }
        }));
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/SharedConst.js
let SharedConst = (() => {
    class SharedConst {
    }
    SharedConst.Const = {
        IterHelper: {
            GrowthPerIteration: 0.5,
            MaxCount: {
                Default: 10,
                OverridePublishing: 15,
            },
            Timeouts: {
                Max: 10000,
                Default: 100,
            },
        },
        Settings: {
            Defaults: {
                LogToConsole: true,
            }
        },
        Regex: {
            ContentEditor: /Content.*?Editor/ig,
            CleanGuid: /{|-|}/ig,
            NbSp: /&nbsp;/ig,
            QueryStrSeparatorQuest: /\?/gi,
            PageType: {
                Desktop: /.*default.aspx/ig,
                Edit: /sc_itemid=.*sc_mode=edit/ig,
                Normal: /sc_itemid=.*sc_mode=normal/ig,
                Preview: /sc_itemid=.*sc_mode=preview/ig,
            },
        },
        UrlSuffix: {
            Desktop: '/sitecore/shell/default.aspx',
            Login: '/sitecore/login',
            LaunchPad: '/client/applications/launchpad',
            CE: '/sitecore/shell/Applications/Content Editor.aspx?sc_bw=1',
            None: '/',
        },
    };
    return SharedConst;
})();


// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/HelperBase.js
class HelperBase {
    constructor(helperHub, helperAgents) {
        this.HelperHub = helperHub;
        this.AllHelperAgents = helperAgents;
    }
    GuidHelp() { return this.HelperHub.GuidHelp; }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/IterationHelper.js


class IterationHelper_IterationHelper extends HelperBase {
    constructor(helperHub, nickname, allHelperAgents, maxIterations = null) {
        super(helperHub, allHelperAgents);
        this.IsExhaustedMsg = 'Iteration helper exhausted';
        if (!maxIterations) {
            maxIterations = SharedConst.Const.IterHelper.MaxCount.Default;
        }
        this.__maxIterations = maxIterations;
        this.__currentIteration = maxIterations;
        this.__timeout = SharedConst.Const.IterHelper.Timeouts.Default;
        this.__nickName = nickname;
        this.IsExhausted = false;
    }
    DecrementAndKeepGoing() {
        var toReturn = false;
        if (this.__currentIteration > 0) {
            this.__currentIteration -= 1;
            this.__timeout += this.__timeout * SharedConst.Const.IterHelper.GrowthPerIteration;
            if (this.__timeout > SharedConst.Const.IterHelper.Timeouts.Max) {
                this.__timeout = SharedConst.Const.IterHelper.Timeouts.Max;
            }
            this.AllHelperAgents.LoggerAgent.Log('DecrementAndKeepGoing: ' + this.__nickName + ' ' + this.__currentIteration + ':' + this.__maxIterations + ' | timeout: ' + this.__timeout);
            toReturn = true;
        }
        else {
            this.IsExhausted = true;
            this.NotifyExhausted();
            toReturn = false;
        }
        return toReturn;
    }
    NotifyExhausted() {
        this.AllHelperAgents.LoggerAgent.Log('Iteration: ' + this.__nickName + ' counter exhausted ' + this.__currentIteration + ':' + this.__maxIterations);
    }
    WaitAndThen(timeoutFunction) {
        this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitAndThen.name, this.__nickName + ' ' + timeoutFunction.name);
        var self = this;
        setTimeout(timeoutFunction(), self.__timeout);
        this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitAndThen.name, this.__nickName);
    }
    Wait() {
        if (!this.OperationCancelled) {
            return new Promise((resolve) => {
                setTimeout(resolve, this.__timeout);
            });
        }
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Promises/PromiseChainRestoreDesktop.js
var PromiseChainRestoreDesktop_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class PromiseChainRestoreDesktop_PromiseChainRestoreDesktop extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(PromiseChainRestoreDesktop_PromiseChainRestoreDesktop.name);
        this.ContentAgents.Logger.FuncEnd(PromiseChainRestoreDesktop_PromiseChainRestoreDesktop.name);
    }
    __waitForAndClickRedStartButtonPromise(promiseBucket) {
        return new Promise((resolve, reject) => PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.__waitForAndClickRedStartButtonPromise.name);
            if (this.MiscMan().NotNullOrUndefined([promiseBucket, promiseBucket.targetDoc], this.__waitForAndClickRedStartButtonPromise.name)) {
                this.ContentAgents.Logger.MarkerB();
                yield this.Helpers().PromiseHelp.RaceWaitAndClick(InjectConst_ContentConst.Const.Selector.SC.scStartButton, promiseBucket.targetDoc)
                    .then(() => resolve(promiseBucket))
                    .catch(ex => {
                    this.ContentAgents.Logger.Error(this.__waitForAndClickRedStartButtonPromise.name, ex);
                    reject(ex);
                });
            }
            else {
                reject(this.__waitForAndClickRedStartButtonPromise.name + ' something was null or undefined');
            }
            this.ContentAgents.Logger.FuncEnd(this.__waitForAndClickRedStartButtonPromise.name);
        }));
    }
    __waitForIframeReady(promiseBucket) {
        return new Promise((resolve, reject) => PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.__waitForIframeReady.name, 'promiseBucket not null: ' + (promiseBucket !== null));
            this.ContentAgents.Logger.PromiseBucketDebug(promiseBucket, this.__waitForIframeReady.name);
            var success = yield this.Helpers().PromiseHelp.WaitForReadyIframe(promiseBucket.NewIframe);
            if (success) {
                this.ContentAgents.Logger.Log('resolved! : ');
                promiseBucket.NewIframe.ContentDoc.ContentDoc = promiseBucket.NewIframe.IframeElem.contentDocument;
                this.ContentAgents.Logger.DebugDataOneIframe(promiseBucket.NewIframe);
                resolve(promiseBucket);
            }
            else {
                this.ContentAgents.Logger.Log('rejected ! : ');
                reject(this.__waitForIframeReady.name);
            }
            this.ContentAgents.Logger.FuncEnd(this.__waitForIframeReady.name);
        }));
    }
    __waitForIframeCountDiff(promiseBucket) {
        return new Promise((resolve, reject) => PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.__waitForIframeCountDiff.name);
            var result = new PromiseResult(this.__waitForIframeCountDiff.name, this.ContentAgents.Logger);
            var iframeResult = yield this.OneScWinMan().OneDesktopMan.WaitForIframeCountDiffWorker(promiseBucket.IFramesbefore);
            this.ContentAgents.Logger.MarkerB();
            if (iframeResult) {
                this.ContentAgents.Logger.MarkerC();
                promiseBucket.NewIframe = iframeResult;
                this.ContentAgents.Logger.DebugDataOneIframe(promiseBucket.NewIframe);
                result.MarkSuccessful();
            }
            else {
                result.MarkFailed('no iframe result');
            }
            this.ContentAgents.Logger.FuncEnd(this.__waitForIframeCountDiff.name);
            if (result.WasSuccessful) {
                resolve(promiseBucket);
            }
            else {
                reject(result.RejectReasons);
            }
        }));
    }
    __waitForAndThenClickCEFromMenuPromise(promiseBucket) {
        return new Promise((resolve, reject) => PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.StartMenuLeftOption], promiseBucket.targetDoc)
                .then(() => { resolve(promiseBucket); })
                .catch((ex) => { reject(this.__waitForAndThenClickCEFromMenuPromise.name); });
        }));
    }
    __restoreDataToOneIframe(promiseBucket) {
        return new Promise((resolve, reject) => PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.__restoreDataToOneIframe.name);
            this.ContentAgents.Logger.DebugDataOneIframe(promiseBucket.NewIframe);
            var success = yield this.OneScWinMan().OneDesktopMan.RestoreDataToOneIframeWorker(promiseBucket.oneCEdata, promiseBucket.NewIframe);
            if (success) {
                resolve(promiseBucket);
            }
            else {
                reject(this.__restoreDataToOneIframe.name);
            }
            this.ContentAgents.Logger.FuncEnd(this.__restoreDataToOneIframe.name);
        }));
    }
    RunOneChain(targetDoc, dataToRestore) {
        return PromiseChainRestoreDesktop_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RunOneChain.name);
            if (this.MiscMan().NotNullOrUndefined([targetDoc, dataToRestore], this.RunOneChain.name)) {
                var allIframeData = this.OneScWinMan().OneDesktopMan.GetAllLiveIframeData();
                var dataBucket = {
                    targetDoc: targetDoc,
                    IFramesbefore: allIframeData,
                    oneCEdata: dataToRestore,
                    NewIframe: null,
                    LastChainLinkSuccessful: false,
                };
                yield this.__waitForAndClickRedStartButtonPromise(dataBucket)
                    .then(dataBucket => this.__waitForAndThenClickCEFromMenuPromise(dataBucket))
                    .then(dataBucket => this.__waitForIframeCountDiff(dataBucket))
                    .then(dataBucket => this.__waitForIframeReady(dataBucket))
                    .then(dataBucket => this.__restoreDataToOneIframe(dataBucket))
                    .catch(ex => {
                    this.ContentAgents.Logger.Error(this.RunOneChain.name, ex);
                });
                this.ContentAgents.Logger.FuncEnd(this.RunOneChain.name);
            }
        });
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/OneTreeManager.js


class OneTreeManager_OneTreeManager extends ContentManagerBase {
    constructor(hub, associatedDoc, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(OneTreeManager_OneTreeManager.name);
        this.AssociatedDoc = associatedDoc;
        this.ContentAgents.Logger.FuncEnd(OneTreeManager_OneTreeManager.name);
    }
    GetFriendlyNameFromNode(inputNode) {
        this.ContentAgents.Logger.FuncStart(this.GetFriendlyNameFromNode.name);
        var toReturn = 'unknown';
        var parentNode = inputNode.parentNode;
        var treeNode = parentNode.querySelector(InjectConst_ContentConst.Const.Selector.SC.IdStartsWithTreeNode);
        if (treeNode) {
            toReturn = treeNode.innerText;
        }
        else {
            this.ContentAgents.Logger.Log('No treeNode');
        }
        this.ContentAgents.Logger.FuncEnd(this.GetFriendlyNameFromNode.name, toReturn);
        return toReturn;
    }
    __isActive(targetNode) {
        var toReturn = false;
        var firstNodeActiveTest = targetNode.querySelector(InjectConst_ContentConst.Const.Selector.SC.IdStartsWithTreeNode);
        if (firstNodeActiveTest) {
            var className = firstNodeActiveTest.className;
            if (className.indexOf(InjectConst_ContentConst.Const.ClassNames.SC.scContentTreeNodeActive) > -1) {
                toReturn = true;
                this.ContentAgents.Logger.Log('** isActive ' + targetNode.innerText);
            }
        }
        return toReturn;
    }
    __isExpanded(firstImg) {
        var toReturn = false;
        if (firstImg) {
            var srcAttr = firstImg.getAttribute('src');
            if (srcAttr.indexOf(InjectConst_ContentConst.Const.Names.SC.TreeExpandedPng.sc920) > -1) {
                toReturn = true;
            }
            return toReturn;
        }
    }
    __isContentTreeNode(targetNode) {
        var toReturn = false;
        var className = targetNode.className;
        if (className === InjectConst_ContentConst.Const.ClassNames.ContentTreeNode) {
            toReturn = true;
        }
        return toReturn;
    }
    WalkNodeRecursive(targetNode, depth) {
        var toReturn = [];
        depth = depth - 1;
        if (targetNode) {
            var firstImg = targetNode.querySelector(InjectConst_ContentConst.Const.Selector.SC.ContentTreeNodeGlyph);
            if (this.__isContentTreeNode(targetNode)) {
                var newData = {
                    IsExpanded: this.__isExpanded(firstImg),
                    IsActive: this.__isActive(targetNode),
                    NodeFriendly: '',
                    NodeId: null
                };
                if (newData.IsExpanded || newData.IsActive) {
                    newData.NodeFriendly = this.GetFriendlyNameFromNode(firstImg);
                    var apparentId = firstImg.id.replace(InjectConst_ContentConst.Const.Names.SC.TreeGlyphPrefix, '');
                    newData.NodeId = this.ContentHub.Helpers.GuidHelp.ParseGuid(apparentId);
                    toReturn.push(newData);
                }
            }
            var childNodes = targetNode.children;
            if (childNodes && childNodes.length > 0 && depth > 0) {
                for (var jdx = 0; jdx < childNodes.length; jdx++) {
                    var oneChild = childNodes[jdx];
                    toReturn = toReturn.concat(this.WalkNodeRecursive(oneChild, depth));
                }
            }
        }
        return toReturn;
    }
    GetOneLiveTreeData() {
        this.ContentAgents.Logger.FuncStart(this.GetOneLiveTreeData.name);
        this.ContentAgents.Logger.Log('targetDoc isnull: ' + (this.AssociatedDoc === null));
        var toReturn = [];
        if (this.AssociatedDoc) {
            this.ContentAgents.Logger.LogVal('Looking for node ID: ', InjectConst_ContentConst.Const.ElemId.sc.SitecoreRootNodeId);
            this.ContentAgents.Logger.DebugIDataOneDoc(this.AssociatedDoc);
            var rootNode = this.AssociatedDoc.ContentDoc.getElementById(InjectConst_ContentConst.Const.ElemId.sc.SitecoreRootNodeId);
            if (rootNode) {
                this.ContentAgents.Logger.Log('rootNode: ' + rootNode.innerHTML);
                var rootParent = rootNode.parentElement;
                toReturn = this.WalkNodeRecursive(rootParent, InjectConst_ContentConst.Const.MaxIter);
                this.ContentAgents.Logger.Log('foundNodes count: ' + toReturn.length);
            }
            else {
                this.ContentAgents.Logger.Error(this.GetOneLiveTreeData.name, 'no root node');
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.GetOneLiveTreeData.name, 'no targetDoc');
        }
        this.ContentAgents.Logger.FuncEnd(this.GetOneLiveTreeData.name);
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/OneCEManager.js
var OneCEManager_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class OneCEManager_OneCEManager extends ContentManagerBase {
    constructor(hub, associatedDoc, allContentAgents) {
        super(hub, allContentAgents);
        this.AssociatedDoc = associatedDoc;
        this.OneTreeMan = new OneTreeManager_OneTreeManager(hub, this.AssociatedDoc, allContentAgents);
    }
    __activateNode(hotTreeNode) {
        this.ContentAgents.Logger.FuncStart(this.__activateNode.name);
        this.ContentAgents.Logger.Log('clicking it');
        hotTreeNode.click();
        this.ContentAgents.Logger.FuncEnd(this.__activateNode.name);
    }
    __expandNode(foundOnPage) {
        this.ContentAgents.Logger.FuncStart(this.__expandNode.name);
        var currentSrc = foundOnPage.getAttribute('src');
        this.ContentAgents.Logger.Log('currentSrc' + currentSrc);
        if (currentSrc.indexOf(InjectConst_ContentConst.Const.Names.TreeMenuExpandedPng) < 0) {
            this.ContentAgents.Logger.Log('clicking it');
            foundOnPage.click();
        }
        this.ContentAgents.Logger.FuncEnd(this.__expandNode.name);
    }
    __collapseNode(element) {
        var currentSrc = element.getAttribute('src');
        this.ContentAgents.Logger.Log('currentSrc' + currentSrc);
        if (currentSrc.indexOf(InjectConst_ContentConst.Const.Names.TreeMenuExpandedPng) > -1) {
            this.ContentAgents.Logger.Log('clicking it');
            element.click();
        }
    }
    __collapseRootNode(targetCEDoc) {
        var rootElem = targetCEDoc.ContentDoc.getElementById(InjectConst_ContentConst.Const.ElemId.sc.SitecoreRootGlyphId);
        if (rootElem) {
            this.__collapseNode(rootElem);
        }
        else {
            this.ContentAgents.Logger.Error(this.__collapseRootNode.name, 'Root glyph not found ' + InjectConst_ContentConst.Const.ElemId.sc.SitecoreRootGlyphId);
        }
    }
    WaitForAndRestoreOneNode(nextNode, dataOneDocTarget) {
        return OneCEManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.WaitForAndRestoreOneNode.name, dataOneDocTarget.DocId.AsShort);
            var treeGlyphTargetId = InjectConst_ContentConst.Const.Names.SC.TreeGlyphPrefix + nextNode.NodeId.AsString;
            this.ContentAgents.Logger.Log('looking for: ' + treeGlyphTargetId + ' ' + nextNode.NodeFriendly + ' in ' + dataOneDocTarget.DocId.AsShort);
            this.ContentAgents.Logger.Log('document not null ' + (dataOneDocTarget.ContentDoc != null));
            var iterHelper = new IterationHelper_IterationHelper(this.Helpers(), this.WaitForAndRestoreOneNode.name, this.ContentAgents.HelperAgents);
            var foundOnPageTreeGlyph = null;
            while (!foundOnPageTreeGlyph && iterHelper.DecrementAndKeepGoing()) {
                this.ContentAgents.Logger.Log('looking for: *' + treeGlyphTargetId + '* ' + nextNode.NodeFriendly + ' in *' + dataOneDocTarget.DocId.AsShort + '*');
                foundOnPageTreeGlyph = dataOneDocTarget.ContentDoc.getElementById(treeGlyphTargetId);
                if (foundOnPageTreeGlyph) {
                    if (nextNode.IsExpanded) {
                        this.__expandNode(foundOnPageTreeGlyph);
                    }
                    if (nextNode.IsActive) {
                        var hotTreeNodeId = InjectConst_ContentConst.Const.Names.SC.TreeNodePrefix + nextNode.NodeId.AsString;
                        var hotTreeNode = dataOneDocTarget.ContentDoc.getElementById(hotTreeNodeId);
                        if (hotTreeNode) {
                            this.__activateNode(hotTreeNode);
                        }
                    }
                }
                else {
                    this.ContentAgents.Logger.Log('not Found...waiting: ');
                    yield iterHelper.Wait();
                }
            }
            this.ContentAgents.Logger.FuncEnd(this.WaitForAndRestoreOneNode.name, dataOneDocTarget.DocId.AsShort);
        });
    }
    WaitForAndRestoreManyAllNodes(storageData, dataOneDocTarget) {
        return OneCEManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.WaitForAndRestoreManyAllNodes.name, dataOneDocTarget.DocId.AsShort);
            let iterHelper = new IterationHelper_IterationHelper(this.Helpers(), this.WaitForAndRestoreManyAllNodes.name, this.ContentAgents.HelperAgents);
            while (storageData.AllTreeNodeAr.length > 0 && iterHelper.DecrementAndKeepGoing()) {
                var nextNode = storageData.AllTreeNodeAr.shift();
                yield this.WaitForAndRestoreOneNode(nextNode, dataOneDocTarget);
            }
            this.ContentAgents.Logger.FuncEnd(this.WaitForAndRestoreManyAllNodes.name);
        });
    }
    RestoreCEStateAsync(dataToRestore, dataOneDocTarget) {
        return OneCEManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RestoreCEStateAsync.name, dataOneDocTarget.DocId.AsShort);
            var toReturn = false;
            this.ContentAgents.Logger.Log('Node Count in storage data: ' + dataToRestore.AllTreeNodeAr.length);
            yield this.WaitForAndRestoreManyAllNodes(dataToRestore, dataOneDocTarget);
            this.ContentAgents.Logger.FuncEnd(this.RestoreCEStateAsync.name);
            return toReturn;
        });
    }
    GetActiveNode(allTreeNodeAr) {
        let toReturn = null;
        if (allTreeNodeAr) {
            for (var idx = 0; idx < allTreeNodeAr.length; idx++) {
                let candidate = allTreeNodeAr[idx];
                if (candidate.IsActive) {
                    toReturn = candidate;
                    break;
                }
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.GetActiveNode.name, 'No tree data provided');
        }
        return toReturn;
    }
    GetStateCe(id) {
        return new Promise((resolve, reject) => {
            this.ContentAgents.Logger.FuncStart(this.GetStateCe.name);
            let result = new PromiseResult(this.GetStateCe.name, this.ContentAgents.Logger);
            var toReturnCEData = {
                Id: id,
                AllTreeNodeAr: this.OneTreeMan.GetOneLiveTreeData(),
                ActiveNode: null
            };
            toReturnCEData.ActiveNode = this.GetActiveNode(toReturnCEData.AllTreeNodeAr);
            if (toReturnCEData) {
                result.MarkSuccessful();
            }
            else {
                result.MarkFailed('todo why would this fail?');
            }
            this.ContentAgents.Logger.FuncEnd(this.GetStateCe.name);
            if (result.WasSuccessful()) {
                resolve(toReturnCEData);
            }
            else {
                reject(result.RejectReasons);
            }
        });
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/OneDesktopManager.js
var OneDesktopManager_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






class OneDesktopManager_OneDesktopManager extends ContentManagerBase {
    constructor(hub, associatedDoc, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(OneDesktopManager_OneDesktopManager.name);
        this.associatedDoc = associatedDoc;
        this.ContentAgents.Logger.FuncEnd(OneDesktopManager_OneDesktopManager.name);
    }
    RestoreDesktopState(targetDoc, dataToRestore) {
        return OneDesktopManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RestoreDesktopState.name);
            ;
            if (this.MiscMan().NotNullOrUndefined([targetDoc, dataToRestore, dataToRestore.AllCEAr], this.RestoreDesktopState.name)) {
                for (var idx = 0; idx < dataToRestore.AllCEAr.length; idx++) {
                    this.ContentAgents.Logger.Log('data idx: ' + idx + ':' + dataToRestore.AllCEAr.length);
                    var desktopPromiser = new PromiseChainRestoreDesktop_PromiseChainRestoreDesktop(this.ContentHub, this.ContentAgents);
                    yield desktopPromiser.RunOneChain(targetDoc, dataToRestore.AllCEAr[idx]);
                }
            }
            this.ContentAgents.Logger.FuncEnd(this.RestoreDesktopState.name);
        });
    }
    RestoreDataToOneIframeWorker(oneCEdata, newIframe) {
        return OneDesktopManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RestoreDataToOneIframeWorker.name, 'data not null: ' + (oneCEdata != null) + ' newFrame not null: ' + (newIframe !== null));
            var toReturn = false;
            this.ContentAgents.Logger.DebugDataOneIframe(newIframe);
            if (oneCEdata && newIframe) {
                yield this.OneScWinMan().OneCEMan.RestoreCEStateAsync(oneCEdata, newIframe.ContentDoc);
                toReturn = true;
            }
            else {
                this.ContentAgents.Logger.Error(this.RestoreDataToOneIframeWorker.name, 'bad data');
                toReturn = false;
            }
            this.ContentAgents.Logger.FuncEnd(this.RestoreDataToOneIframeWorker.name, toReturn.toString());
            return toReturn;
        });
    }
    WaitForIframeCountDiffWorker(IFramesbefore) {
        return OneDesktopManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.WaitForIframeCountDiffWorker.name);
            var toReturn = null;
            var iterationJr = new IterationHelper_IterationHelper(this.Helpers(), this.WaitForIframeCountDiffWorker.name, this.ContentAgents.HelperAgents);
            while (!toReturn && iterationJr.DecrementAndKeepGoing()) {
                let beforeCount = IFramesbefore.length;
                var allIframesAfter = this.GetAllLiveIframeData();
                var count = allIframesAfter.length;
                this.ContentAgents.Logger.Log('iFrame count before: ' + IFramesbefore.length);
                this.ContentAgents.Logger.Log('iFrame count after: ' + allIframesAfter.length);
                if (count > beforeCount) {
                    var newIframes = allIframesAfter.filter(e => !IFramesbefore.includes(e));
                    toReturn = newIframes[0];
                }
                else {
                    yield iterationJr.Wait();
                }
            }
            this.ContentAgents.Logger.FuncEnd(this.WaitForIframeCountDiffWorker.name);
            return toReturn;
        });
    }
    GetAllLiveIframeData() {
        this.ContentAgents.Logger.FuncStart(this.GetAllLiveIframeData.name);
        this.ContentAgents.Logger.DebugIDataOneDoc(this.associatedDoc);
        var toReturn = [];
        this.ContentAgents.Logger.LogVal('querySelectorAll 9.2: ', InjectConst_ContentConst.Const.Selector.SC.IframeContent.sc920);
        var iframeAr = this.associatedDoc.ContentDoc.querySelectorAll(InjectConst_ContentConst.Const.Selector.SC.IframeContent.sc920);
        if (!iframeAr) {
            iframeAr = this.associatedDoc.ContentDoc.querySelectorAll(InjectConst_ContentConst.Const.Selector.SC.IframeContent.sc820);
        }
        this.ContentAgents.Logger.LogVal('found iframes count', iframeAr.length);
        if (iframeAr) {
            this.ContentAgents.Logger.Log('iframeAr: ' + iframeAr.length);
            for (var ifrIdx = 0; ifrIdx < iframeAr.length; ifrIdx++) {
                this.ContentAgents.Logger.Log('pushing: ' + ifrIdx);
                var iframeElem = iframeAr[ifrIdx];
                var dataOneIframe = this.Helpers().FactoryHelp.DataOneIframeFactory(iframeElem, 'desktop Iframe_' + ifrIdx);
                toReturn.push(dataOneIframe);
            }
        }
        else {
            this.ContentAgents.Logger.Log('no iframes found');
        }
        this.ContentAgents.Logger.LogVal('iframe count', toReturn.length);
        this.ContentAgents.Logger.FuncEnd(this.GetAllLiveIframeData.name, 'count:  ' + toReturn.length);
        return toReturn;
    }
    GetStateDesktop() {
        return new Promise((resolve, reject) => OneDesktopManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.GetStateDesktop.name);
            this.ContentAgents.Logger.DebugIDataOneDoc(this.associatedDoc);
            let promiseResult = new PromiseResult(this.GetStateDesktop.name, this.ContentAgents.Logger);
            var toReturnAllCeState = this.Helpers().FactoryHelp.CreateNewDtDataShell();
            toReturnAllCeState.livingIframeAr = this.GetAllLiveIframeData();
            if (toReturnAllCeState.livingIframeAr && toReturnAllCeState.livingIframeAr.length > 0) {
                for (var iframeIdx = 0; iframeIdx < toReturnAllCeState.livingIframeAr.length; iframeIdx++) {
                    this.ContentAgents.Logger.LogVal('iframeIdx: ', iframeIdx);
                    var targetIframeObj = toReturnAllCeState.livingIframeAr[iframeIdx];
                    var oneCeMan = new OneCEManager_OneCEManager(this.ContentHub, targetIframeObj.ContentDoc, this.ContentAgents);
                    yield oneCeMan.GetStateCe(this.Helpers().GuidHelp.EmptyGuid())
                        .then((oneCeState) => {
                        toReturnAllCeState.AllCeData.push(oneCeState);
                        if (targetIframeObj.Zindex === 1) {
                            toReturnAllCeState.ActiveCeMan = oneCeMan;
                            toReturnAllCeState.ActiveCeState = oneCeState;
                        }
                        promiseResult.MarkSuccessful();
                    })
                        .catch((err) => promiseResult.MarkFailed(err));
                    if (!promiseResult.WasSuccessful) {
                        break;
                    }
                }
            }
            else {
                promiseResult.MarkSuccessful();
            }
            this.ContentAgents.Logger.FuncEnd(this.GetStateDesktop.name);
            if (promiseResult.WasSuccessful()) {
                resolve(toReturnAllCeState);
            }
            else {
                reject(promiseResult.RejectReasons);
            }
        }));
    }
}
;

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/OneScWindowManager.js
var OneScWindowManager_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






class OneScWindowManager_OneScWindowManager extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.OneDesktopMan = null;
        this.OneCEMan = null;
        this.ContentAgents.Logger.FuncStart(OneScWindowManager_OneScWindowManager.name);
        this.ContentAgents.Logger.FuncEnd(OneScWindowManager_OneScWindowManager.name);
    }
    Init() {
        let currPageType = this.ScUiMan().GetCurrentPageType();
        if (currPageType === scWindowType.Desktop) {
            this.OneDesktopMan = new OneDesktopManager_OneDesktopManager(this.ContentHub, this.ScUiMan().TopLevelDoc(), this.ContentAgents);
        }
        else if (currPageType === scWindowType.ContentEditor) {
            this.OneCEMan = new OneCEManager_OneCEManager(this.ContentHub, this.ScUiMan().TopLevelDoc(), this.ContentAgents);
        }
    }
    SaveWindowState(snapShotSettings) {
        return new Promise((resolve, reject) => OneScWindowManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.SaveWindowState.name);
            let promiseResult = new PromiseResult(this.SaveWindowState.name, this.ContentAgents.Logger);
            var snapShot = this.Helpers().FactoryHelp.CreateShellIDataOneWindowStorage(snapShotSettings.CurrentPageType, snapShotSettings.Flavor);
            if (snapShotSettings) {
                if (snapShotSettings.SnapShotNewNickname) {
                    snapShot.NickName = snapShotSettings.SnapShotNewNickname;
                }
                snapShot.Flavor = snapShotSettings.Flavor;
            }
            if (snapShotSettings.CurrentPageType === scWindowType.ContentEditor) {
                this.ContentAgents.Logger.MarkerA();
                var id = this.ContentHub.Helpers.GuidHelp.EmptyGuid();
                yield this.OneCEMan.GetStateCe(id)
                    .then((state) => {
                    snapShot.AllCEAr.push(state);
                    promiseResult.MarkSuccessful();
                })
                    .catch((err) => promiseResult.MarkFailed(err));
            }
            else if (snapShotSettings.CurrentPageType === scWindowType.Desktop) {
                this.ContentAgents.Logger.MarkerB();
                yield this.OneDesktopMan.GetStateDesktop()
                    .then((states) => {
                    snapShot.AllCEAr = states.AllCeData;
                    promiseResult.MarkSuccessful();
                })
                    .catch((err) => promiseResult.MarkFailed(err));
            }
            else {
                this.ContentAgents.Logger.Error(this.SaveWindowState.name, 'Invalid page location ' + snapShotSettings.CurrentPageType);
            }
            this.ContentAgents.Logger.FuncEnd(this.SaveWindowState.name);
            if (promiseResult.WasSuccessful) {
                yield this.AtticMan().WriteToStorage(snapShot)
                    .then(promiseResult.MarkSuccessful)
                    .catch((err) => promiseResult.MarkFailed(err));
            }
            if (promiseResult.WasSuccessful()) {
                resolve();
            }
            else {
                reject(promiseResult.RejectReasons);
            }
        }));
    }
    __getTopLevelIframe(targetDoc) {
        var toReturn = null;
        var allIframe = this.OneDesktopMan.GetAllLiveIframeData();
        var maxZVal = -1;
        if (allIframe && allIframe.length > 0) {
            for (var idx = 0; idx < allIframe.length; idx++) {
                var candidateIframe = allIframe[idx];
                if (candidateIframe && candidateIframe.Zindex > maxZVal) {
                    toReturn = candidateIframe;
                    maxZVal = candidateIframe.Zindex;
                }
            }
        }
        return toReturn;
    }
    PublishActiveCE(targetDoc) {
        return OneScWindowManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.PublishActiveCE.name);
            var currentWindowType = this.ScUiMan().GetCurrentPageType();
            var docToPublish = null;
            if (currentWindowType === scWindowType.Desktop) {
                var topIframe = this.__getTopLevelIframe(targetDoc);
                if (topIframe) {
                    docToPublish = topIframe.ContentDoc;
                }
            }
            else {
                docToPublish = this.ScUiMan().TopLevelDoc();
            }
            this.ContentAgents.Logger.Log('docToPublish', this.ContentAgents.Logger.IsNullOrUndefined(docToPublish));
            if (docToPublish) {
                var publishChain = new PromiseChainQuickPublish_PromiseChainQuickPublish(this.ContentHub, this.ContentAgents);
                yield publishChain.PublishCE(docToPublish);
            }
            this.ContentAgents.Logger.FuncEnd(this.PublishActiveCE.name);
        });
    }
    RestoreWindowStateToTarget(targetDoc, dataToRestore) {
        return OneScWindowManager_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.RestoreWindowStateToTarget.name);
            if (dataToRestore) {
                if (dataToRestore.WindowType === scWindowType.ContentEditor) {
                    yield this.OneCEMan.RestoreCEStateAsync(dataToRestore.AllCEAr[0], targetDoc);
                }
                else if (dataToRestore.WindowType === scWindowType.Desktop) {
                    yield this.OneDesktopMan.RestoreDesktopState(targetDoc, dataToRestore);
                }
                else {
                    this.ContentAgents.Logger.Error(this.RestoreWindowStateToTarget.name, 'No match found for snap shot');
                }
                this.ContentAgents.Logger.FuncEnd(this.RestoreWindowStateToTarget.name);
            }
        });
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/PromiseGeneric.js
var PromiseGeneric_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class PromiseGeneric_PromiseHelper extends HelperBase {
    WaitForReadyIframe(dataOneIframe) {
        return PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForReadyIframe.name, dataOneIframe.Nickname + ' ' + dataOneIframe.Id.AsShort);
                var iterationJr = new IterationHelper_IterationHelper(this.HelperHub, this.WaitForReadyIframe.name, this.AllHelperAgents);
                let promiseResult = new PromiseResult(this.WaitForReadyIframe.name, this.AllHelperAgents.LoggerAgent);
                while (iterationJr.DecrementAndKeepGoing() && !promiseResult.WasSuccessful()) {
                    var currentReadyState = dataOneIframe.IframeElem.contentDocument.readyState.toString();
                    var isReadyStateComplete = currentReadyState === 'complete';
                    if (isReadyStateComplete) {
                        promiseResult.MarkSuccessful();
                    }
                    else {
                        yield iterationJr.Wait();
                    }
                }
                if (iterationJr.IsExhausted) {
                    promiseResult.MarkFailed(iterationJr.IsExhaustedMsg);
                }
                this.AllHelperAgents.LoggerAgent.LogAsJsonPretty('dataOneIframe', dataOneIframe);
                this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitForReadyIframe.name);
                if (promiseResult.WasSuccessful()) {
                    resolve();
                }
                else {
                    reject(promiseResult.RejectReasons);
                }
            }));
        });
    }
    WaitForPageReadyNative(targetDoc) {
        return PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForPageReadyNative.name);
                var result = new PromiseResult(this.WaitForPageReadyNative.name, this.AllHelperAgents.LoggerAgent);
                this.AllHelperAgents.LoggerAgent.DebugIDataOneDoc(targetDoc);
                var iterationJr = new IterationHelper_IterationHelper(this.HelperHub, this.WaitForPageReadyNative.name, this.AllHelperAgents);
                var isReady = false;
                this.AllHelperAgents.LoggerAgent.MarkerA();
                while (iterationJr.DecrementAndKeepGoing() && !isReady) {
                    this.AllHelperAgents.LoggerAgent.MarkerB();
                    var currentReadyState = targetDoc.ContentDoc.readyState.toString();
                    var isReadyStateComplete = currentReadyState === 'complete';
                    this.AllHelperAgents.LoggerAgent.LogVal('readyState', currentReadyState);
                    ;
                    this.AllHelperAgents.LoggerAgent.LogVal('isReadyStateComplete', isReadyStateComplete);
                    if (isReadyStateComplete) {
                        isReady = true;
                        result.MarkSuccessful();
                    }
                    else {
                        yield iterationJr.Wait();
                    }
                }
                if (iterationJr.IsExhausted) {
                    result.MarkFailed(iterationJr.IsExhaustedMsg);
                }
                this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitForPageReadyNative.name, 'ready state: ' + currentReadyState + ' is ready: ' + isReady.toString());
                ;
                if (result.WasSuccessful()) {
                    resolve();
                }
                else {
                    reject(result.RejectReasons);
                }
            }));
        });
    }
    WaitForIframeElemAndReturnWhenReady(haystackDoc, selector, iframeNickName) {
        return PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForIframeElemAndReturnWhenReady.name);
                var toReturnIframeData = null;
                let promiseResult = new PromiseResult(this.WaitForIframeElemAndReturnWhenReady.name, this.AllHelperAgents.LoggerAgent);
                yield this.WaitForAndReturnFoundElem(haystackDoc, selector)
                    .then((foundElem) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                    if (foundElem) {
                        toReturnIframeData = this.HelperHub.FactoryHelp.DataOneIframeFactory(foundElem, iframeNickName);
                    }
                }))
                    .then(() => this.WaitForReadyIframe(toReturnIframeData))
                    .then(() => {
                    toReturnIframeData.ContentDoc = this.HelperHub.FactoryHelp.DataOneContentDocFactoryFromIframe(toReturnIframeData);
                    promiseResult.MarkSuccessful();
                })
                    .catch((err) => promiseResult.MarkFailed(err));
                this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitForIframeElemAndReturnWhenReady.name);
                if (promiseResult.WasSuccessful()) {
                    resolve(toReturnIframeData);
                }
                else {
                    reject(promiseResult.RejectReasons);
                }
            }));
        });
    }
    WaitForAndReturnFoundElem(haystackDoc, selector, overrideIterCount = 8) {
        return PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForAndReturnFoundElem.name);
                this.AllHelperAgents.LoggerAgent.LogVal('selector', selector);
                this.AllHelperAgents.LoggerAgent.LogVal('doc nickname', haystackDoc.Nickname);
                var toReturnFoundElem = null;
                let promiseResult = new PromiseResult(this.WaitForAndReturnFoundElem.name, this.AllHelperAgents.LoggerAgent);
                var iterationJr = new IterationHelper_IterationHelper(this.HelperHub, this.WaitForAndReturnFoundElem.name, this.AllHelperAgents, overrideIterCount);
                while (!toReturnFoundElem && iterationJr.DecrementAndKeepGoing()) {
                    this.AllHelperAgents.LoggerAgent.LogVal('targetDoc.Document', haystackDoc.ContentDoc.toString());
                    this.AllHelperAgents.LoggerAgent.LogVal('targetDoc.Document.location', haystackDoc.ContentDoc.location.toString());
                    this.AllHelperAgents.LoggerAgent.LogVal('targetDoc.Document.location.href', haystackDoc.ContentDoc.location.href);
                    toReturnFoundElem = haystackDoc.ContentDoc.querySelector(selector);
                    if (toReturnFoundElem) {
                        this.AllHelperAgents.LoggerAgent.Log('found');
                        this.AllHelperAgents.LoggerAgent.LogVal('found.style.display', toReturnFoundElem.style.display);
                        promiseResult.MarkSuccessful();
                    }
                    else {
                        yield iterationJr.Wait();
                    }
                }
                if (!toReturnFoundElem && iterationJr.IsExhausted) {
                    promiseResult.MarkFailed(iterationJr.IsExhaustedMsg);
                }
                this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitForAndReturnFoundElem.name);
                if (promiseResult.WasSuccessful()) {
                    resolve(toReturnFoundElem);
                }
                else {
                    reject(promiseResult.RejectReasons);
                }
            }));
        });
    }
    WaitForAndClickWithPayload(selector, targetDoc, payload) {
        return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForAndClickWithPayload.name, selector);
            yield this.WaitForThenClick([selector], targetDoc)
                .then(() => resolve(payload))
                .catch(ex => {
                this.AllHelperAgents.LoggerAgent.Error(this.WaitForAndClickWithPayload.name, ex);
                reject(ex);
            });
        }));
    }
    TabWaitForReadyStateCompleteNative(browserTab) {
        return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            let iterHelper = new IterationHelper_IterationHelper(this.HelperHub, this.TabWaitForReadyStateCompleteNative.name, this.AllHelperAgents);
            let result = new PromiseResult(this.TabWaitForReadyStateCompleteNative.name, this.AllHelperAgents.LoggerAgent);
            while (browserTab.status !== 'complete' && iterHelper.DecrementAndKeepGoing()) {
                this.AllHelperAgents.LoggerAgent.LogVal('tab status', browserTab.status);
                yield iterHelper.Wait;
            }
            if (browserTab.status === 'complete') {
                result.MarkSuccessful();
            }
            else {
                result.MarkFailed('browser status: ' + browserTab.status);
                if (iterHelper.IsExhausted) {
                    result.MarkFailed(iterHelper.IsExhaustedMsg);
                }
            }
            if (result.WasSuccessful()) {
                resolve();
            }
            else {
                reject(result.RejectReasons);
            }
        }));
    }
    TabChainSetHrefWaitForComplete(href, targetTab) {
        return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            this.AllHelperAgents.LoggerAgent.FuncStart(this.TabChainSetHrefWaitForComplete.name, href.AbsUrl);
            try {
                yield browser.tabs.update(targetTab.Tab.id, { url: href.AbsUrl })
                    .then(() => this.TabWaitForReadyStateCompleteNative(targetTab.Tab))
                    .then(resolve)
                    .catch(reject);
            }
            catch (e) {
                this.AllHelperAgents.LoggerAgent.Error(this.TabChainSetHrefWaitForComplete.name, e.toString());
                reject(e);
            }
            this.AllHelperAgents.LoggerAgent.FuncEnd(this.TabChainSetHrefWaitForComplete.name, href.AbsUrl);
        }));
    }
    RaceWaitAndClick(selector, targetDoc) {
        return PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
                this.AllHelperAgents.LoggerAgent.FuncStart(this.RaceWaitAndClick.name);
                yield this.WaitForThenClick([selector.sc920, selector.sc820], targetDoc)
                    .then(() => {
                    this.AllHelperAgents.LoggerAgent.FuncEnd(this.RaceWaitAndClick.name);
                    resolve();
                })
                    .catch((ex) => {
                    this.AllHelperAgents.LoggerAgent.FuncEnd(this.RaceWaitAndClick.name);
                    reject(ex);
                });
            }));
        });
    }
    WaitForThenClick(selectorAr, targetDoc) {
        return new Promise((resolve, reject) => PromiseGeneric_awaiter(this, void 0, void 0, function* () {
            this.AllHelperAgents.LoggerAgent.FuncStart(this.WaitForThenClick.name);
            let promiseResults = new PromiseResult(this.WaitForThenClick.name, this.AllHelperAgents.LoggerAgent);
            if (targetDoc) {
                this.AllHelperAgents.LoggerAgent.LogAsJsonPretty('selectors', selectorAr);
                var found = null;
                var iterationJr = new IterationHelper_IterationHelper(this.HelperHub, this.WaitForThenClick.name, this.AllHelperAgents);
                while (!found && iterationJr.DecrementAndKeepGoing()) {
                    for (var idx = 0; idx < selectorAr.length; idx++) {
                        found = targetDoc.ContentDoc.querySelector(selectorAr[idx]);
                        if (found) {
                            this.AllHelperAgents.LoggerAgent.LogVal('found target', selectorAr[idx]);
                            break;
                        }
                    }
                    if (found) {
                        this.AllHelperAgents.LoggerAgent.Log('clicking');
                        try {
                            found.click();
                            promiseResults.MarkSuccessful();
                        }
                        catch (e) {
                            promiseResults.MarkFailed(e);
                        }
                    }
                    else {
                        yield iterationJr.Wait();
                    }
                }
            }
            else {
                promiseResults.MarkFailed('no target doc');
            }
            if (!found && iterationJr.IsExhausted) {
                promiseResults.MarkFailed(iterationJr.IsExhaustedMsg);
            }
            this.AllHelperAgents.LoggerAgent.FuncEnd(this.WaitForThenClick.name);
            if (promiseResults.WasSuccessful()) {
                resolve();
            }
            else {
                reject(promiseResults.RejectReasons);
            }
        }));
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Promises/PromiseOneStep.js
var PromiseOneStep_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class PromiseOneStep_PromiseOneStep extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(PromiseGeneric_PromiseHelper.name);
        this.ContentAgents.Logger.FuncEnd(PromiseGeneric_PromiseHelper.name);
    }
    ClickPublishOnNav(payload) {
        return PromiseOneStep_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.NavPublishStrip], payload.docToPublish);
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.NavPublishStrip], payload.docToPublish);
            return payload;
        });
    }
    ClickMenuButtonPublishDropDown(payload = null) {
        return PromiseOneStep_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.MenuButtonPublish], payload.docToPublish);
            return payload;
        });
    }
    ClickMenuDropDownPublishItem(payload = null) {
        return PromiseOneStep_awaiter(this, void 0, void 0, function* () {
            return yield this.Helpers().PromiseHelp.WaitForAndClickWithPayload(InjectConst_ContentConst.Const.Selector.SC.MenuDropDownPublishItem, payload.docToPublish, payload);
        });
    }
    GetThePublishItemDialog(dataPublishChain = null) {
        return PromiseOneStep_awaiter(this, void 0, void 0, function* () {
            yield this.Helpers().PromiseHelp.WaitForAndReturnFoundElem(dataPublishChain.TopLevelDoc, InjectConst_ContentConst.Const.Selector.SC.JqueryModalDialogsFrame)
                .then((found) => {
                dataPublishChain.jqIframe = this.Helpers().FactoryHelp.DataOneIframeFactory(found, 'jqIframe');
                return dataPublishChain;
            })
                .then((payload) => PromiseOneStep_awaiter(this, void 0, void 0, function* () {
                yield this.Helpers().PromiseHelp.WaitForReadyIframe(payload.jqIframe);
                dataPublishChain = payload;
            }));
            return dataPublishChain;
        });
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/PayloadDataReqPopUp.js
class PayloadDataFromPopUp {
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Interfaces/MsgFromXBase.js

class MsgFromXBase_MsgFromXBase {
    constructor(msgFlag) {
        this.MsgFlag = MsgFlag.Unknown;
        this.MsgFlag = msgFlag;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/MsgFromPopUp.js



class MsgFromPopUp_MsgFromPopUp extends MsgFromXBase_MsgFromXBase {
    constructor(msgFlag, popHub) {
        super(msgFlag);
        this.Data = new PayloadDataFromPopUp();
        this.Data.IdOfSelect = popHub.UiMan.CurrentMenuState.SelectSnapshotId;
        this.Data.SnapShotSettings = {
            SnapShotNewNickname: '',
            Flavor: SnapShotFlavor.Unknown,
            CurrentPageType: popHub.TabMan.CurrentTabData.UrlParts.ScWindowType
        };
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/PayloadDataFromContent.js
class PayloadDataFromContent {
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/MsgPayloadResponseFromContent.js



class MsgPayloadResponseFromContent_MsgFromContent extends MsgFromXBase_MsgFromXBase {
    constructor(msgFlag) {
        super(msgFlag);
        this.Data = new PayloadDataFromContent();
        this.ContentState = {
            SnapShotsMany: {
                CurrentSnapShots: [],
                FavoriteCount: 0,
                SnapShotsAutoCount: 0,
                PlainCount: 0,
                Birthday: new Date(1970),
            },
            LastReq: MsgFlag.Unknown,
            ErrorStack: [],
            LastReqSuccessful: false,
            LastReqFailReason: '',
            ActiveCe: null
        };
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Agents/SettingsAgent/SettingsAgent.js
class SettingsAgent {
    GetByKey(settingKey, settingAr) {
        var toReturn;
        for (var idx = 0; idx < settingAr.length; idx++) {
            if (settingAr[idx].SettingKey === settingKey) {
                toReturn = settingAr[idx];
                break;
            }
        }
        return toReturn;
    }
    static ValueAsInteger(setting) {
        let toReturn = 0;
        if (setting) {
            toReturn = setting.ValueAsObj;
        }
        return toReturn;
    }
    static ValueAsBool(setting) {
        let toReturn = false;
        if (setting) {
            toReturn = setting.ValueAsObj;
        }
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/ContentMessageManager.js
var ContentMessageManager_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};













class ContentMessageManager_ContentMessageManager extends ContentManagerBase {
    constructor(contentHub, contentAgents) {
        super(contentHub, contentAgents);
        this.AutoSaveHasBeenScheduled = false;
        this.ContentAgents.Logger.FuncStart(ContentMessageManager_ContentMessageManager.name);
        var self = this;
        browser.runtime.onMessage.addListener(request => self.ContentReceiveRequest(request));
        this.ContentAgents.Logger.FuncEnd(ContentMessageManager_ContentMessageManager.name);
    }
    ValidateRequest(reqMsgFromPopup) {
        this.ContentAgents.Logger.FuncStart(this.ValidateRequest.name);
        var isValid = true;
        if (reqMsgFromPopup) {
            if (reqMsgFromPopup.CurrentContentPrefs) {
                if (reqMsgFromPopup.Data) {
                }
                else {
                    reqMsgFromPopup.Data = new PayloadDataFromPopUp();
                }
            }
            else {
                this.ContentAgents.Logger.Error(this.ValidateRequest.name, 'No CurrentContentPrefs');
                reqMsgFromPopup.IsValid = false;
                isValid = false;
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.ValidateRequest.name, 'no reqMsgFromPopup');
        }
        reqMsgFromPopup.IsValid = isValid;
        this.ContentAgents.Logger.FuncEnd(this.ValidateRequest.name, isValid.toString());
        return reqMsgFromPopup;
    }
    ScheduleIntervalTasks(reqMsgFromPopup) {
        this.ContentAgents.Logger.FuncStart(this.ScheduleIntervalTasks.name);
        this.ContentAgents.Logger.LogVal('Has been scheduled: ', this.AutoSaveHasBeenScheduled);
        let autoSaveSetting = this.ContentAgents.SettingsAgent.GetByKey(SettingKey.AutoSaveIntervalMin, reqMsgFromPopup.CurrentContentPrefs);
        if (SettingsAgent.ValueAsInteger(autoSaveSetting) > 0) {
            if (!this.AutoSaveHasBeenScheduled) {
                this.ContentAgents.Logger.MarkerA();
                var self = this;
                this.ContentAgents.Logger.MarkerB();
                var intervalMs = StaticHelpers_StaticHelpers.MinToMs(InjectConst_ContentConst.Const.Timeouts.AutoSaveIntervalMin);
                this.ContentAgents.Logger.MarkerC();
                window.setInterval(() => {
                    self.AutoSaveSnapShot(this.ScUiMan().GetCurrentPageType());
                }, intervalMs);
                this.ContentAgents.Logger.MarkerD();
                this.AutoSaveHasBeenScheduled = true;
            }
        }
        this.ContentAgents.Logger.FuncEnd(this.ScheduleIntervalTasks.name);
    }
    AutoSaveSnapShot(pageType) {
        this.ContentAgents.Logger.FuncStart(this.AutoSaveSnapShot.name);
        var SnapShotSettings = {
            SnapShotNewNickname: '',
            Flavor: SnapShotFlavor.Autosave,
            CurrentPageType: pageType
        };
        this.OneScWinMan().SaveWindowState(SnapShotSettings);
        this.ContentAgents.Logger.FuncEnd(this.AutoSaveSnapShot.name);
    }
    SetLoggerFromMessage(reqMsgFromPopup) {
        let currSetting = this.ContentAgents.SettingsAgent.GetByKey(SettingKey.LogToConsole, reqMsgFromPopup.CurrentContentPrefs);
        let valueToUse = SharedConst.Const.Settings.Defaults.LogToConsole;
        if (currSetting) {
            let candidate = SettingsAgent.ValueAsBool(currSetting);
            if (candidate) {
                console.log('setting value as bool ' + valueToUse);
                console.log('setting it to ' + valueToUse);
            }
            else {
                console.log('candidate was null');
            }
            this.ContentAgents.Logger.Init(valueToUse);
        }
        else {
            console.log('curr setting not found');
        }
    }
    ContentReceiveRequest(reqMsgFromPopup) {
        return ContentMessageManager_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => ContentMessageManager_awaiter(this, void 0, void 0, function* () {
                this.ContentAgents.Logger.FuncStart(this.ContentReceiveRequest.name, StaticHelpers_StaticHelpers.MsgFlagAsString(reqMsgFromPopup.MsgFlag));
                var promResult = new PromiseResult(this.ContentReceiveRequest.name, this.ContentAgents.Logger);
                this.ContentAgents.Logger.LogAsJsonPretty(MsgFromPopUp_MsgFromPopUp.name, reqMsgFromPopup);
                var response = null;
                if (reqMsgFromPopup) {
                    reqMsgFromPopup = this.ValidateRequest(reqMsgFromPopup);
                    if (reqMsgFromPopup.IsValid) {
                        this.SetLoggerFromMessage(reqMsgFromPopup);
                        this.ScheduleIntervalTasks(reqMsgFromPopup);
                        yield this.ReqMsgRouter(reqMsgFromPopup)
                            .then((result) => {
                            response = result;
                            promResult.MarkSuccessful();
                        })
                            .catch((err) => promResult.MarkFailed(err));
                    }
                    else {
                        promResult.MarkFailed('reqMsgFromPopup is not valid');
                    }
                }
                else {
                    promResult.MarkFailed('no request');
                }
                if (response !== null) {
                    this.ContentAgents.Logger.LogVal('responding', StaticHelpers_StaticHelpers.MsgFlagAsString(response.MsgFlag));
                }
                this.ContentAgents.Logger.FuncEnd(this.ContentReceiveRequest.name, StaticHelpers_StaticHelpers.MsgFlagAsString(reqMsgFromPopup.MsgFlag));
                if (promResult.WasSuccessful()) {
                    resolve(response);
                }
                else {
                    response = new MsgPayloadResponseFromContent_MsgFromContent(MsgFlag.RespError);
                    response.ContentState.LastReqFailReason = promResult.RejectReasons;
                    reject(promResult.RejectReasons);
                }
            }));
        });
    }
    Init() {
        this.ContentAgents.Logger.FuncStart(this.Init.name + ' ' + ContentMessageManager_ContentMessageManager.name);
        var self = this;
        this.ContentAgents.Logger.FuncEnd(this.Init.name);
    }
    NotifyCompleteOnContent(targetDoc = null, Message) {
        if (!targetDoc) {
            targetDoc = this.ScUiMan().TopLevelDoc();
        }
        let bodyTag = targetDoc.ContentDoc.getElementsByTagName('body')[0];
        var flagElem = targetDoc.ContentDoc.createElement('div');
        flagElem.innerHTML = '<div>' + Message + '</div>';
        flagElem.style.position = 'absolute';
        flagElem.style.top = '100px';
        flagElem.style.left = '100px';
        flagElem.style.backgroundColor = 'yellow';
        flagElem.style.zIndex = '999';
        flagElem.style.fontSize = '40px';
        setTimeout(function () {
            flagElem.remove();
            window.close();
        }, InjectConst_ContentConst.Const.Timeouts.WaitBeforeRemovingCompleteFlagOnContent);
        bodyTag.appendChild(flagElem);
    }
    ReqMsgRouter(payload) {
        return ContentMessageManager_awaiter(this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => ContentMessageManager_awaiter(this, void 0, void 0, function* () {
                this.ContentAgents.Logger.FuncStart(this.ReqMsgRouter.name, StaticHelpers_StaticHelpers.MsgFlagAsString(payload.MsgFlag));
                this.ContentAgents.Logger.LogAsJsonPretty(MsgFromPopUp_MsgFromPopUp.name, payload);
                let promiseResult = new PromiseResult(this.ReqMsgRouter.name, this.ContentAgents.Logger);
                var response = yield this.ContentFactory().NewMsgFromContentShell();
                switch (payload.MsgFlag) {
                    case MsgFlag.ReqRestoreToNewTab:
                        console.log('we are going to restore to this window');
                        break;
                    case MsgFlag.ReqAddCETab:
                        yield this.Helpers().PromiseHelp.RaceWaitAndClick(InjectConst_ContentConst.Const.Selector.SC.scStartButton, this.ScUiMan().TopLevelDoc())
                            .then(() => { this.Helpers().PromiseHelp.WaitForThenClick([InjectConst_ContentConst.Const.Selector.SC.StartMenuLeftOption], this.ScUiMan().TopLevelDoc()); })
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.ReqAdminB:
                        this.ScUiMan().AdminB(this.ScUiMan().TopLevelDoc(), null);
                        break;
                    case MsgFlag.Ping:
                        this.ContentAgents.Logger.LogVal('Ping', StaticHelpers_StaticHelpers.MsgFlagAsString(payload.MsgFlag));
                        if (this.ReadyForMessages) {
                            response.MsgFlag = MsgFlag.RespListeningAndReady;
                            promiseResult.MarkSuccessful();
                        }
                        else {
                            promiseResult.MarkFailed('not ready');
                        }
                        break;
                    case MsgFlag.ReqCurState:
                        response.MsgFlag = MsgFlag.RespCurState;
                        promiseResult.MarkSuccessful();
                        break;
                    case MsgFlag.ReqOpenCE:
                        break;
                    case MsgFlag.ReqMarkFavorite:
                        this.AtticMan().MarkFavorite(payload.Data)
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.ReqQuickPublish:
                        yield this.OneScWinMan().PublishActiveCE(this.ScUiMan().TopLevelDoc())
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.ReqRestoreClick:
                        yield this.__restoreClick(payload.Data)
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.ReqTakeSnapShot:
                        yield this.OneScWinMan().SaveWindowState(payload.Data.SnapShotSettings)
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.RemoveFromStorage:
                        yield this.AtticMan().RemoveOneFromStorage(payload.Data.IdOfSelect)
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    case MsgFlag.RespTaskSuccessful:
                        this.NotifyCompleteOnContent(null, payload.Data.ScreenMessage);
                    case MsgFlag.ReqUpdateNickName:
                        yield this.AtticMan().UpdateNickname(payload.Data)
                            .then(promiseResult.MarkSuccessful)
                            .catch((err) => promiseResult.MarkFailed(err));
                        break;
                    default:
                        this.ContentAgents.Logger.Error('Unhandled MsgFlag', StaticHelpers_StaticHelpers.MsgFlagAsString(payload.MsgFlag));
                        promiseResult.MarkFailed('Unhandled MsgFlag ' + StaticHelpers_StaticHelpers.MsgFlagAsString(payload.MsgFlag));
                        break;
                }
                yield this.ContentFactory().UpdateContentState(response.ContentState)
                    .then((result) => response.ContentState = result)
                    .catch((err) => promiseResult.MarkFailed(err));
                response.ContentState.LastReq = payload.MsgFlag;
                this.ContentAgents.Logger.FuncEnd(this.ReqMsgRouter.name);
                if (promiseResult.WasSuccessful()) {
                    response.MsgFlag = MsgFlag.RespTaskSuccessful;
                    resolve(response);
                }
                else {
                    reject(promiseResult.RejectReasons);
                }
            }));
        });
    }
    __restoreClick(Data) {
        return new Promise((resolve, reject) => ContentMessageManager_awaiter(this, void 0, void 0, function* () {
            let promiseResult = new PromiseResult(this.__restoreClick.name, this.ContentAgents.Logger);
            try {
                this.ContentAgents.Logger.MarkerA();
                var dataOneWindowStorage = this.AtticMan().GetFromStorageById(Data.IdOfSelect, CacheMode.OkToUseCache);
                this.ContentAgents.Logger.MarkerB();
                var self = this;
                var targetDoc = this.ScUiMan().TopLevelDoc();
                if (targetDoc) {
                    yield self.OneScWinMan().RestoreWindowStateToTarget(targetDoc, dataOneWindowStorage)
                        .then(promiseResult.MarkSuccessful)
                        .catch((err) => promiseResult.MarkFailed(err));
                }
                else {
                    self.ContentAgents.Logger.Error(this.__restoreClick.name, 'no target window');
                }
            }
            catch (ex) {
                this.ContentAgents.Logger.Error(this.__restoreClick.name, ex);
            }
            if (promiseResult.WasSuccessful()) {
                resolve();
            }
            else {
                reject(promiseResult.RejectReasons);
            }
        }));
    }
    IsLogEnabled() {
        return this.ContentAgents.Logger.EnabledStatus();
    }
    SetParentInfo(__winDataParent) {
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Classes/ContentFactories.js
var ContentFactories_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








class ContentFactories_ContentFactories extends ContentManagerBase {
    constructor(hub, contentAgents) {
        super(hub, contentAgents);
        this.ContentAgents.Logger.FuncStart(PromiseGeneric_PromiseHelper.name);
        this.ContentAgents.Logger.FuncEnd(PromiseGeneric_PromiseHelper.name);
    }
    UpdateContentState(contentState) {
        return new Promise((resolve, reject) => ContentFactories_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.UpdateContentState.name);
            let promiseResult = new PromiseResult(this.UpdateContentState.name, this.ContentAgents.Logger);
            contentState.SnapShotsMany = yield this.AtticMan().GetAllSnapShotsMany(CacheMode.OkToUseCache);
            contentState.ErrorStack = this.ContentAgents.Logger.ErrorStack;
            this.ContentAgents.Logger.LogAsJsonPretty('ContentState', contentState);
            yield this.GetCurrentDtOrCeState()
                .then((result) => {
                contentState.ActiveCe = result;
                promiseResult.MarkSuccessful();
            })
                .catch((err) => promiseResult.MarkFailed(err));
            this.ContentAgents.Logger.FuncEnd(this.UpdateContentState.name);
            if (promiseResult.WasSuccessful()) {
                resolve(contentState);
            }
            else {
                reject(promiseResult.RejectReasons);
            }
        }));
    }
    GetCurrentDtOrCeState() {
        return new Promise((resolve, reject) => ContentFactories_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.GetCurrentDtOrCeState.name);
            let promiseResult = new PromiseResult(this.GetCurrentDtOrCeState.name, this.ContentAgents.Logger);
            let toReturnCeState = null;
            let pageType = this.ScUiMan().GetCurrentPageType();
            if (pageType === scWindowType.Desktop) {
                var currState;
                yield this.OneScWinMan().OneDesktopMan.GetStateDesktop()
                    .then((result) => {
                    toReturnCeState = result.ActiveCeState;
                    promiseResult.MarkSuccessful();
                })
                    .catch((ex) => promiseResult.MarkFailed(ex));
            }
            else if (pageType === scWindowType.ContentEditor) {
                toReturnCeState = null;
                yield this.OneScWinMan().OneCEMan.GetStateCe(this.Helpers().GuidHelp.NewGuid())
                    .then((result) => {
                    toReturnCeState = result;
                    promiseResult.MarkSuccessful();
                })
                    .catch((ex) => promiseResult.MarkFailed(ex));
            }
            else if (pageType === scWindowType.LoginPage
                || pageType === scWindowType.Launchpad
                || pageType === scWindowType.Edit
                || pageType === scWindowType.Preview
                || pageType === scWindowType.Normal) {
                toReturnCeState = null;
                promiseResult.MarkSuccessful();
            }
            else {
                toReturnCeState = null;
                promiseResult.MarkFailed('not a known page type ' + StaticHelpers_StaticHelpers.WindowTypeAsString(pageType));
            }
            this.ContentAgents.Logger.FuncEnd(this.GetCurrentDtOrCeState.name);
            if (promiseResult.WasSuccessful()) {
                resolve(toReturnCeState);
            }
            else {
                reject(promiseResult.RejectReasons);
            }
        }));
    }
    NewMsgFromContentShell() {
        return ContentFactories_awaiter(this, void 0, void 0, function* () {
            this.ContentAgents.Logger.FuncStart(this.NewMsgFromContentShell.name);
            var response = new MsgPayloadResponseFromContent_MsgFromContent(MsgFlag.Unknown);
            this.ContentAgents.Logger.FuncEnd(this.NewMsgFromContentShell.name);
            return response;
        });
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/SitecoreUiManager.js


class SitecoreUiManager_SitecoreUiManager extends ContentManagerBase {
    GetCurrentPageType() {
        return this.Helpers().UrlHelp.CalcPageTypeFromHref({ AbsUrl: document.location.href });
    }
    TopLevelDoc() {
        if (!this.topDoc) {
            this.topDoc = {
                ContentDoc: window.document,
                DocId: this.Helpers().GuidHelp.NewGuid(),
                Nickname: 'top doc'
            };
        }
        return this.topDoc;
    }
    AdminB(targetDoc, callbackOnComplete) {
        this.ContentAgents.Logger.FuncStart(this.AdminB.name, 'targetDoc: ' + targetDoc.DocId.AsShort);
        this.ContentAgents.Logger.Log('callback passed: ' + (callbackOnComplete !== null));
        var userNameElem = targetDoc.ContentDoc.getElementById(InjectConst_ContentConst.Const.ElemId.sc.scLoginUserName);
        var passwordElem = targetDoc.ContentDoc.getElementById(InjectConst_ContentConst.Const.ElemId.sc.scLoginPassword);
        if (this.ContentAgents.Logger.IsNotNullOrUndefinedBool('userNameElem', userNameElem)
            &&
                this.ContentAgents.Logger.IsNotNullOrUndefinedBool('passwordElem', passwordElem)) {
            userNameElem.setAttribute('value', InjectConst_ContentConst.Const.Names.scDefaultAdminUserName);
            passwordElem.setAttribute('value', InjectConst_ContentConst.Const.Names.scDefaultAdminPassword);
            var loginButton = this.GetLoginButton(targetDoc);
            if (this.ContentAgents.Logger.IsNotNullOrUndefinedBool('loginButton', loginButton)) {
                this.ContentAgents.Logger.Log('clicking');
                loginButton.click();
                if (callbackOnComplete) {
                    this.ContentAgents.Logger.Log('Triggering callback');
                    setTimeout(callbackOnComplete, InjectConst_ContentConst.Const.Timeouts.PostLoginBtnClick);
                }
                else {
                    this.ContentAgents.Logger.Log('no callback passed');
                }
            }
            else {
                this.ContentAgents.Logger.Error(this.AdminB.name, 'No loginButton');
            }
        }
        else {
            this.ContentAgents.Logger.Error(this.AdminB.name, 'No Username or password field');
        }
        this.ContentAgents.Logger.FuncEnd(this.AdminB.name);
    }
    GetLoginButton(targetDoc) {
        this.ContentAgents.Logger.FuncStart(this.GetLoginButton.name);
        var toReturn = targetDoc.ContentDoc.getElementById(InjectConst_ContentConst.Const.ElemId.sc.scLoginBtn.sc920);
        if (!toReturn) {
            toReturn = targetDoc.ContentDoc.querySelector(InjectConst_ContentConst.Const.Selector.SC.LoginBtn.sc820);
        }
        this.ContentAgents.Logger.Log('toReturn: ' + toReturn);
        this.ContentAgents.Logger.FuncEnd(this.GetLoginButton.name);
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Helpers/GuidHelper.js


class GuidHelper_GuidHelper extends HelperBase {
    constructor() {
        super(...arguments);
        this.ShortGuidLength = 4;
    }
    EmptyGuid() {
        return this.ParseGuid('00000000-0000-0000-0000-000000000000');
    }
    newGuidString() {
        var toReturn;
        var temp = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';
        toReturn = temp.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0;
            var v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
        return toReturn;
    }
    NewGuid() {
        var toReturn = this.ParseGuid(this.newGuidString());
        return toReturn;
    }
    ShortGuid(Id) {
        var toReturn = '{error}';
        if (Id && Id.AsString.length > this.ShortGuidLength) {
            toReturn = Id.AsString.substr(0, this.ShortGuidLength);
        }
        else {
            this.AllHelperAgents.LoggerAgent.DebugIGuid(Id);
            this.AllHelperAgents.LoggerAgent.LogVal('Length', Id.AsString.length);
            this.AllHelperAgents.LoggerAgent.LogVal('ShortLength', this.ShortGuidLength);
        }
        return toReturn;
    }
    FormatJustNumbers(str) {
        return str.replace(SharedConst.Const.Regex.CleanGuid, '');
    }
    FormatAsBracedGuid(str) {
        var parts = [];
        parts.push(str.slice(0, 8));
        parts.push(str.slice(8, 12));
        parts.push(str.slice(12, 16));
        parts.push(str.slice(16, 20));
        parts.push(str.slice(20, 32));
        var GUID = '{' + parts.join('-') + '}';
        return GUID;
    }
    ParseGuid(val) {
        let justNumbers = this.FormatJustNumbers(val);
        let guidFormat = this.FormatAsBracedGuid(justNumbers);
        let toReturn = {
            AsString: justNumbers,
            AsBracedGuid: guidFormat,
            AsShort: '',
            Type: 'IGuid'
        };
        toReturn.AsShort = this.ShortGuid(toReturn);
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Helpers/UtilityHelper.js






class UtilityHelper_UtilityHelper extends HelperBase {
    constructor() {
        super(...arguments);
        this.lenTimestamp = 13;
        this.lenNickname = 16;
        this.lenPageType = 7;
        this.lenPrefix = 6;
        this.lenShortId = 4;
        this.colSep = ' - ';
        this.lenCeCount = 3;
        this.lenActiveNode = 16;
        this.lenFavorite = 3;
    }
    SelectHeaderStr(prefix) {
        let toReturn = StaticHelpers_StaticHelpers.BufferString('Time Stamp', this.lenTimestamp, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('Type', this.lenPageType, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('Nickname', this.lenNickname, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('Active Node.', this.lenActiveNode, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('Fav.', this.lenFavorite, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('Id', this.lenShortId, BufferChar.Period, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString('#CE', this.lenCeCount, BufferChar.Period, BufferDirection.right);
        return toReturn;
    }
    MakeSelectorFromId(TabId) {
        return '[id=' + TabId + ']';
    }
    TimeNicknameFavStr(data) {
        var typeStr = '';
        if (data.WindowType === scWindowType.ContentEditor) {
            typeStr = 'Cont Ed';
        }
        else if (data.WindowType === scWindowType.Desktop) {
            typeStr = 'Desktop';
        }
        var activeCeNode = '';
        for (var idx = 0; idx < data.AllCEAr.length; idx++) {
            var candidateCe = data.AllCEAr[idx];
            for (var jdx = 0; jdx < candidateCe.AllTreeNodeAr.length; jdx++) {
                var candidateNode = candidateCe.AllTreeNodeAr[jdx];
                if (candidateNode.IsActive) {
                    var lvl2Node = '';
                    if (jdx >= 2) {
                        lvl2Node = candidateCe.AllTreeNodeAr[1].NodeFriendly + '/';
                    }
                    activeCeNode = lvl2Node + candidateNode.NodeFriendly;
                    break;
                }
            }
        }
        let toReturn = StaticHelpers_StaticHelpers.BufferString(this.MakeFriendlyDate(data.TimeStamp), this.lenTimestamp, BufferChar.space, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString(typeStr, this.lenPageType, BufferChar.Nbsp, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString(data.NickName, this.lenNickname, BufferChar.Nbsp, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString(activeCeNode, this.lenActiveNode, BufferChar.Nbsp, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString((data.Flavor === SnapShotFlavor.Favorite ? '*' : ''), this.lenFavorite, BufferChar.Nbsp, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString(data.Id.AsShort, this.lenShortId, BufferChar.Nbsp, BufferDirection.right)
            + this.colSep + StaticHelpers_StaticHelpers.BufferString(data.AllCEAr.length.toString(), this.lenCeCount, BufferChar.Nbsp, BufferDirection.right);
        return toReturn;
    }
    TimeNicknameFavStrForConfirmation(data) {
        var result = this.TimeNicknameFavStr(data);
        result = result.replace(new RegExp(/&nbsp;/ig), '');
        return result;
    }
    MakeFriendlyDate(date) {
        var toReturn = '';
        var workingDate = new Date(date);
        if (workingDate) {
            var month = StaticHelpers_StaticHelpers.BufferString((workingDate.getMonth() + 1).toString(), 2, BufferChar.Zero, BufferDirection.left);
            var day = StaticHelpers_StaticHelpers.BufferString(workingDate.getDate().toString(), 2, BufferChar.Zero, BufferDirection.left);
            var min = StaticHelpers_StaticHelpers.BufferString(workingDate.getMinutes().toString(), 2, BufferChar.Zero, BufferDirection.left);
            var hoursRaw = workingDate.getHours();
            var ampm = hoursRaw >= 12 ? 'p' : 'a';
            hoursRaw = hoursRaw % 12;
            var hourClean = hoursRaw ? hoursRaw : 12;
            var hourCleanStr = StaticHelpers_StaticHelpers.BufferString(hourClean.toString(), 2, BufferChar.Zero, BufferDirection.left);
            toReturn = month + '.' + day + ' ' + hourCleanStr + ':' + min + ' ' + ampm;
        }
        else {
            toReturn = '{error}';
            this.AllHelperAgents.LoggerAgent.Error(this.MakeFriendlyDate.name, 'no date provided');
        }
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Helpers/FactoryHelper.js

class FactoryHelper_FactoryHelper extends HelperBase {
    CreateNewDtDataShell() {
        var toReturn = {
            AllCeData: [],
            livingIframeAr: [],
            ActiveCeMan: null,
            ActiveCeState: null
        };
        return toReturn;
    }
    DataOneContentDocFactoryFromIframe(dataOneIframe) {
        var toReturn = null;
        if (dataOneIframe) {
            toReturn =
                {
                    ContentDoc: dataOneIframe.IframeElem.contentDocument,
                    DocId: this.HelperHub.GuidHelp.NewGuid(),
                    Nickname: dataOneIframe.Nickname + ' - content doc'
                };
        }
        else {
            this.AllHelperAgents.LoggerAgent.Error(this.DataOneContentDocFactoryFromIframe.name, 'no iframe provided');
        }
        return toReturn;
    }
    DataOneIframeFactory(iframeElem, nickname) {
        this.AllHelperAgents.LoggerAgent.FuncStart(this.DataOneIframeFactory.name);
        var toReturn = null;
        if (iframeElem && nickname) {
            let zIndex = -1;
            if (iframeElem && iframeElem.style && iframeElem.style.zIndex) {
                zIndex = parseInt(iframeElem.style.zIndex);
            }
            var toReturn = {
                Index: -1,
                IframeElem: iframeElem,
                Id: this.HelperHub.GuidHelp.NewGuid(),
                Zindex: zIndex,
                Nickname: nickname,
                ContentDoc: null,
            };
            toReturn.ContentDoc = this.DataOneContentDocFactoryFromIframe(toReturn);
            this.AllHelperAgents.LoggerAgent.FuncEnd(this.DataOneIframeFactory.name);
        }
        else {
            this.AllHelperAgents.LoggerAgent.Error(this.DataOneIframeFactory.name, 'one of these is null');
            this.AllHelperAgents.LoggerAgent.LogAsJsonPretty('iframeElem', iframeElem);
            this.AllHelperAgents.LoggerAgent.LogAsJsonPretty('nickname', nickname);
        }
        return toReturn;
    }
    CreateShellIDataOneWindowStorage(windowType, flavor) {
        this.AllHelperAgents.LoggerAgent.FuncStart(this.CreateShellIDataOneWindowStorage.name);
        var dateToUse = new Date();
        var newGuid = this.GuidHelp().NewGuid();
        var activeWindowSnapShot = {
            TimeStamp: dateToUse,
            WindowType: windowType,
            WindowFriendly: windowType[windowType],
            AllCEAr: [],
            Id: newGuid,
            NickName: '',
            RawData: null,
            Flavor: flavor,
        };
        this.AllHelperAgents.LoggerAgent.FuncEnd(this.CreateShellIDataOneWindowStorage.name);
        return activeWindowSnapShot;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Helpers/UrlHelper.js



class UrlHelper_UrlHelper extends HelperBase {
    MakeUrlParts(url) {
        var parser = document.createElement('a');
        parser.href = url.AbsUrl;
        let toReturn = {
            OriginalRaw: url.AbsUrl,
            Protocol: parser.protocol,
            HostAndPort: parser.host,
            Parameters: this.ExtractParameters(parser.search),
            FilePath: parser.pathname,
            Anchor: parser.hash,
            ScWindowType: scWindowType.Unknown,
            HasError: false,
        };
        toReturn.ScWindowType = this.CalcPageTypeFromHref(url);
        return toReturn;
    }
    CloneUrlParts(original) {
        let toReturn = {
            Anchor: original.Anchor,
            FilePath: original.FilePath,
            HasError: original.HasError,
            HostAndPort: original.HostAndPort,
            OriginalRaw: original.OriginalRaw,
            Parameters: original.Parameters,
            Protocol: original.Protocol,
            ScWindowType: original.ScWindowType,
        };
        return toReturn;
    }
    BuildEditPrevNormUrl(scMode, contState, urlParts) {
        let toReturn = urlParts;
        urlParts.Anchor = '';
        urlParts.FilePath = '';
        urlParts.Parameters = [];
        urlParts.ScWindowType = scWindowType.Unknown;
        urlParts.Parameters.push({
            Key: 'sc_itemid',
            value: contState.ActiveCe.ActiveNode.NodeId.AsBracedGuid
        });
        urlParts.Parameters.push({
            Key: 'sc_mode',
            value: scMode.AsString
        });
        urlParts.Parameters.push({
            Key: 'sc_lang',
            value: 'en'
        });
        urlParts.Parameters.push({
            Key: 'sc_site',
            value: 'website'
        });
        return toReturn;
    }
    BuildFullUrlFromParts(UrlParts) {
        let toReturn = {
            AbsUrl: '',
        };
        if (UrlParts && !UrlParts.HasError) {
            toReturn.AbsUrl = UrlParts.Protocol + '//' + UrlParts.HostAndPort;
            if (UrlParts.FilePath.length > 0) {
                toReturn.AbsUrl += UrlParts.FilePath;
            }
            if (UrlParts.Parameters && UrlParts.Parameters.length > 0) {
                toReturn.AbsUrl += '?';
                for (var idx = 0; idx < UrlParts.Parameters.length; idx++) {
                    if (idx > 0) {
                        toReturn.AbsUrl += '&';
                    }
                    let oneParam = UrlParts.Parameters[idx];
                    toReturn.AbsUrl += oneParam.Key;
                    if (oneParam.value) {
                        toReturn.AbsUrl += '=' + oneParam.value;
                    }
                }
            }
            if (UrlParts.Anchor.length > 0) {
                toReturn.AbsUrl += '#' + UrlParts.Anchor;
            }
        }
        return toReturn;
    }
    SetScModeFromEditPrevNorm(newValue, urlParts) {
        let toReturn = urlParts;
        if (urlParts && newValue) {
            urlParts = this.SetFilePathFromWindowType(urlParts);
            if (urlParts && urlParts.Parameters && urlParts.Parameters.length > 0)
                for (var idx = 0; idx < urlParts.Parameters.length; idx++) {
                    let candidate = urlParts.Parameters[idx];
                    if (candidate.Key === 'scmode') {
                        candidate.value = newValue.AsString;
                        break;
                    }
                }
        }
        return toReturn;
    }
    SetFilePathFromWindowType(urlParts, windowType = null) {
        let toReturn = urlParts;
        if (!windowType) {
            windowType = urlParts.ScWindowType;
        }
        toReturn.ScWindowType = windowType;
        switch (toReturn.ScWindowType) {
            case scWindowType.ContentEditor:
                toReturn.FilePath = SharedConst.Const.UrlSuffix.CE;
                break;
            case scWindowType.Desktop:
                toReturn.FilePath = SharedConst.Const.UrlSuffix.Desktop;
                break;
            case scWindowType.Edit:
                toReturn.FilePath = SharedConst.Const.UrlSuffix.None;
                break;
            case scWindowType.Preview:
                toReturn.FilePath = SharedConst.Const.UrlSuffix.None;
                break;
            case scWindowType.Normal:
                toReturn.FilePath = SharedConst.Const.UrlSuffix.None;
                break;
            default:
                toReturn.FilePath = '';
                this.AllHelperAgents.LoggerAgent.Error(this.SetFilePathFromWindowType.name, 'unaccounted for window type');
                break;
        }
        return toReturn;
    }
    ExtractParameters(url) {
        let toReturn = [];
        if (url) {
            let splitStr = url.split('?');
            if (splitStr.length > 1) {
                let paramString = splitStr[1].replace(SharedConst.Const.Regex.QueryStrSeparatorQuest, '');
                let pairStr = paramString.split('&');
                if (pairStr && pairStr.length > 0) {
                    for (var idx = 0; idx < pairStr.length; idx++) {
                        let oneParamAr = pairStr[idx].split('=');
                        let paramPair = {
                            Key: '',
                            value: ''
                        };
                        if (oneParamAr) {
                            paramPair.Key = oneParamAr[0];
                            if (oneParamAr.length > 1) {
                                paramPair.value = oneParamAr[1];
                            }
                            toReturn.push(paramPair);
                        }
                    }
                }
            }
        }
        return toReturn;
    }
    ExtractFilePath(url, parser) {
        let toReturn = '';
        parser.protocol;
        parser.hostname;
        parser.port;
        parser.pathname;
        parser.search;
        parser.hash;
        parser.host;
        toReturn = parser.pathname;
        return toReturn;
    }
    ExtractProtocol(url) {
        let toReturn = '';
        if (url.startsWith('https')) {
            toReturn = 'https';
        }
        else {
            toReturn = 'http';
        }
        return toReturn;
    }
    ExtractHostName(url) {
        let toReturn = '';
        if (url.indexOf('//') > -1) {
            toReturn = url.split('/')[2];
        }
        else {
            toReturn = url.split('/')[0];
        }
        toReturn = toReturn.split(':')[0];
        toReturn = toReturn.split('?')[0];
        return toReturn;
    }
    __urlVsRegex(regexPattern, url) {
        return new RegExp(regexPattern).test(url);
    }
    CalcPageTypeFromHref(absUrl) {
        this.AllHelperAgents.LoggerAgent.FuncStart(this.CalcPageTypeFromHref.name);
        var toReturn = scWindowType.Unknown;
        if (absUrl && absUrl.AbsUrl) {
            this.AllHelperAgents.LoggerAgent.LogVal('current url', absUrl.AbsUrl);
            if (absUrl.AbsUrl.indexOf(SharedConst.Const.UrlSuffix.Login) > -1) {
                toReturn = scWindowType.LoginPage;
            }
            else if (new RegExp(SharedConst.Const.Regex.ContentEditor).test(absUrl.AbsUrl)) {
                toReturn = scWindowType.ContentEditor;
            }
            else if (absUrl.AbsUrl.toLowerCase().indexOf(SharedConst.Const.UrlSuffix.LaunchPad.toLowerCase()) > -1) {
                toReturn = scWindowType.Launchpad;
            }
            else if (this.__urlVsRegex(SharedConst.Const.Regex.PageType.Desktop, absUrl.AbsUrl)) {
                toReturn = scWindowType.Desktop;
            }
            else if (this.__urlVsRegex(SharedConst.Const.Regex.PageType.Preview, absUrl.AbsUrl)) {
                toReturn = scWindowType.Preview;
            }
            else if (this.__urlVsRegex(SharedConst.Const.Regex.PageType.Edit, absUrl.AbsUrl)) {
                toReturn = scWindowType.Edit;
            }
            else if (this.__urlVsRegex(SharedConst.Const.Regex.PageType.Normal, absUrl.AbsUrl)) {
                toReturn = scWindowType.Normal;
            }
            else {
                toReturn = scWindowType.Unknown;
            }
        }
        else {
            this.AllHelperAgents.LoggerAgent.Error(this.CalcPageTypeFromHref.name, 'null url');
        }
        this.AllHelperAgents.LoggerAgent.FuncEnd(this.CalcPageTypeFromHref.name, scWindowType[toReturn]);
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Helpers/Helpers.js





class Helpers_HelperHub {
    constructor(helperAgents) {
        helperAgents.LoggerAgent.FuncStart(Helpers_HelperHub.name);
        this.Init(helperAgents);
        helperAgents.LoggerAgent.FuncEnd(Helpers_HelperHub.name);
    }
    Init(helperAgents) {
        this.GuidHelp = new GuidHelper_GuidHelper(this, helperAgents);
        this.UtilityHelp = new UtilityHelper_UtilityHelper(this, helperAgents);
        this.PromiseHelp = new PromiseGeneric_PromiseHelper(this, helperAgents);
        this.FactoryHelp = new FactoryHelper_FactoryHelper(this, helperAgents);
        this.UrlHelp = new UrlHelper_UrlHelper(this, helperAgents);
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/Managers/ContentHub.js










class ContentHub_ContentHub {
    constructor(contentAgents) {
        this.ReadyForMessages = false;
        this.ContentAgents = contentAgents;
        this.ContentAgents.Logger.FuncStart(ContentHub_ContentHub.name);
        console.log('(ctor) logger enabled ' + this.ContentAgents.Logger.EnabledStatus());
        this.Instantiate();
        this.ContentAgents.Logger.FuncEnd(ContentHub_ContentHub.name);
    }
    Instantiate() {
        this.ContentAgents.Logger.FuncStart(this.Instantiate.name);
        this.AtticMan = new ContentAtticManager_ContentAtticManager(this, this.ContentAgents);
        this.Helpers = new Helpers_HelperHub(this.ContentAgents.HelperAgents);
        this.MsgMan = new ContentMessageManager_ContentMessageManager(this, this.ContentAgents);
        this.MiscMan = new MiscManager_MiscManager(this, this.ContentAgents);
        this.ContentFactory = new ContentFactories_ContentFactories(this, this.ContentAgents);
        this.ContentAgents.Logger.MarkerA();
        this.OneWindowMan = new OneScWindowManager_OneScWindowManager(this, this.ContentAgents);
        this.PromiseOneStep = new PromiseOneStep_PromiseOneStep(this, this.ContentAgents);
        this.SharedConst = SharedConst.Const;
        this.SitecoreUiMan = new SitecoreUiManager_SitecoreUiManager(this, this.ContentAgents);
        this.Init();
        this.ContentAgents.Logger.Log('ready for messages');
        this.ReadyForMessages = true;
        this.ContentAgents.Logger.FuncEnd(this.Instantiate.name);
    }
    Init() {
        this.ContentAgents.Logger.FuncStart(ContentHub_ContentHub.constructor.name + ' ' + this.Init.name);
        this.Const = InjectConst_ContentConst.Const;
        this.AtticMan.Init();
        this.MsgMan.Init();
        this.ContentAgents.Logger.SetEnabled(this.MsgMan.IsLogEnabled());
        this.OneWindowMan.Init();
        this.ContentAgents.Logger.FuncEnd(ContentHub_ContentHub.constructor.name + ' ' + this.Init.name);
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/_first/ContentAgents.js
class ContentAgents {
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Classes/AllHelperAgents.js
class AllHelperAgents {
    constructor(loggerAgent, settingsAgent) {
        this.LoggerAgent = loggerAgent;
        this.SettingsAgent = settingsAgent;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Shared/scripts/Agents/LoggerAgent/LoggerAgentBase.js





class LoggerAgentBase_LoggerAgent {
    constructor() {
        this.LogHasBeenInit = false;
        this.ErrorStack = [];
        this.LogPreInitBuffer = [];
        this.__debugTextChangedCallbacks = [];
        this.debugPrefix = '\t\t';
        this.__callDepth = -1;
        console.log('default: ' + SharedConst.Const.Settings.Defaults.LogToConsole);
        this.LogToConsoleEnabled = SharedConst.Const.Settings.Defaults.LogToConsole;
        this.LogHasBeenInit = false;
        console.log('(ctor) Logger log to console enabled: ' + this.LogToConsoleEnabled);
    }
    Init(val) {
        this.LogToConsoleEnabled = val;
        this.LogHasBeenInit = true;
        if (this.LogToConsoleEnabled) {
            var iterCheckMax = 1000;
            while (this.LogPreInitBuffer.length > 0 && iterCheckMax > 0) {
                iterCheckMax--;
                this.Log(this.LogPreInitBuffer.shift());
            }
        }
        console.log('(init) Logger log to console enabled: ' + this.LogToConsoleEnabled);
    }
    SetEnabled(newValue) {
        this.LogToConsoleEnabled = newValue;
        console.log('Logging set to: ' + newValue);
    }
    DebugIDataBrowserTab(browserWindow) {
        if (this.IsNotNullOrUndefinedBool('IDataBrowserWindow', browserWindow)) {
            this.LogVal('WindowType', scWindowType[browserWindow.UrlParts.ScWindowType]);
        }
    }
    EnabledStatus() {
        return this.LogToConsoleEnabled;
    }
    DebugIdataPopUpSettings(toReturn) {
        this.LogVal('Settings', JSON.stringify(toReturn));
    }
    DebugWindow(window) {
        if (this.IsNotNullOrUndefinedBool('window', window)) {
        }
    }
    IsNotNullOrUndefinedBool(title, subject) {
        var toReturn = false;
        if (subject) {
            if ((typeof subject) === 'undefined') {
                this.LogVal(title + ' Is Not Undefined', '!!! false !!!');
            }
            else {
                this.LogVal(title + ' Is Not Null', 'true');
                toReturn = true;
            }
        }
        else {
            this.LogVal(title + ' Is Not Null', '!!! false !!!');
        }
        return toReturn;
    }
    DebugIGuid(id) {
        if (this.IsNotNullOrUndefinedBool('IGuid', id)) {
            this.LogVal('asShort', id.AsShort);
            this.LogVal('asString', id.AsString);
        }
    }
    DebugIDataOneDoc(dataOneDoc) {
        this.FuncStart(this.DebugIDataOneDoc.name);
        this.Log('');
        this.Log(this.debugPrefix + this.DebugIDataOneDoc.name);
        if (dataOneDoc) {
            this.Log(this.debugPrefix + 'dataOneDoc: \t' + this.IsNullOrUndefined(dataOneDoc));
            this.Log(this.debugPrefix + 'dataOneDoc.XyyzId.asShort: \t' + this.IsNullOrUndefined(dataOneDoc.DocId.AsShort));
            this.Log(this.debugPrefix + 'dataOneDoc.Document: \t' + this.IsNullOrUndefined(dataOneDoc.ContentDoc));
            if (dataOneDoc.ContentDoc) {
                this.LogVal(this.debugPrefix + 'dataOneDoc.Document.readyState:', dataOneDoc.ContentDoc.readyState);
                if (dataOneDoc.ContentDoc.location) {
                    this.LogVal(this.debugPrefix + 'targetDoc.location.href', dataOneDoc.ContentDoc.location.href);
                }
                else {
                    this.Log(this.debugPrefix + 'dataOneDoc.Document.location - does not exist');
                }
            }
            else {
                this.Log(this.debugPrefix + 'dataOneDoc.Document - does not exist');
            }
        }
        else {
            this.Error(this.DebugIDataOneDoc.name, 'no targetDoc');
        }
        this.Log('');
    }
    AddDebugTextChangedCallback(caller, callback) {
        this.__debugTextChangedCallbacks.push({
            Caller: caller,
            Func: callback
        });
    }
    HndlrClearDebugText(self, verify = false) {
        this.FuncStart(this.HndlrClearDebugText.name);
        var proceed = true;
        if (verify) {
            proceed = confirm('Clear Debug TextArea ?');
        }
        if (proceed) {
            var newText = '--- Debug Text Reset ---';
            self.__triggerAllDebugTextChangedCallbacks({
                NewText: newText,
                Append: false
            });
        }
        this.FuncEnd(this.HndlrClearDebugText.name);
    }
    MarkerA() {
        this.__markerRaw('A');
    }
    MarkerB() {
        this.__markerRaw('B');
    }
    MarkerC() {
        this.__markerRaw('C');
    }
    MarkerD() {
        this.__markerRaw('D');
    }
    MarkerE() { this.__markerRaw('E'); }
    MarkerF() { this.__markerRaw('F'); }
    __markerRaw(marker) {
        this.Log('Marker ' + marker);
    }
    LogAsJsonPretty(texValName, jsonObj) {
        this.LogVal(texValName, JSON.stringify(jsonObj, null, 1));
    }
    LogVal(textValName, textVal) {
        if (typeof textVal === 'undefined') {
            textVal = '{undefined}';
        }
        else if (textVal === null) {
            textVal = '{null}';
        }
        else {
            var asGuid = textVal;
            if (asGuid.Type === 'IGuid') {
                textVal = asGuid.AsString;
            }
        }
        textVal = textVal.toString();
        textValName = StaticHelpers_StaticHelpers.BufferString(textValName.toString(), 50, BufferChar.space, BufferDirection.right);
        const debugPrefix = '  ~~~  ';
        this.Log(debugPrefix + textValName + ' : ' + textVal);
    }
    Log(text, optionalValue = '', hasPrefix = false) {
        if (this.LogToConsoleEnabled || !this.LogHasBeenInit) {
            var indent = '  ';
            for (var idx = 0; idx < this.__callDepth; idx++) {
                text = indent + text;
            }
            var prefixLength = 3;
            if (!hasPrefix) {
                for (var idx = 0; idx < prefixLength; idx++) {
                    text = ' ' + text;
                }
            }
            this.__triggerAllDebugTextChangedCallbacks({
                NewText: text,
                Append: true
            });
            if (this.LogToConsoleEnabled) {
                console.log(text);
            }
            else if (!this.LogHasBeenInit) {
                this.LogPreInitBuffer.push(text);
            }
        }
    }
    DebugDataOneIframe(dataOneIframe) {
        this.FuncStart(this.DebugDataOneIframe.name);
        this.Log('dataOneIframe : ' + this.IsNullOrUndefined(dataOneIframe));
        if (dataOneIframe) {
            this.Log('dataOneIframe.Nickname : ' + dataOneIframe.Nickname);
            this.Log('dataOneIframe.IframeElem: \t' + this.IsNullOrUndefined(dataOneIframe.IframeElem));
            if (dataOneIframe.IframeElem) {
                this.Log('dataOneIframe.id: \t' + this.IsNullOrUndefined(dataOneIframe.IframeElem.id));
            }
            this.Log('dataOneIframe.ContentDoc: \t' + this.IsNullOrUndefined(dataOneIframe.ContentDoc));
            this.DebugIDataOneDoc(dataOneIframe.ContentDoc);
        }
        this.FuncEnd(this.DebugDataOneIframe.name);
    }
    DebugPayloadDataFromPopUp(data) {
        if (this.IsNotNullOrUndefinedBool('PayloadDataFromPopUp', data)) {
            this.LogVal('idOfSelect', data.IdOfSelect);
            this.DebugIGuid(data.IdOfSelect);
            this.DebugIDataPayloadSnapShot(data.SnapShotSettings);
        }
    }
    DebugIDataPayloadSnapShot(snapShotSettings) {
        if (this.IsNotNullOrUndefinedBool('IDataPayloadSnapShot', snapShotSettings)) {
            this.LogVal('Flavor', StaticHelpers_StaticHelpers.FlavorAsString(snapShotSettings.Flavor));
            this.LogVal('Nickname', snapShotSettings.SnapShotNewNickname);
        }
    }
    DebugObjState(state) {
        if (this.IsNotNullOrUndefinedBool('State', state)) {
            if (this.IsNotNullOrUndefinedBool('CurrentSnapShots', state.SnapShotsMany.CurrentSnapShots)) {
                this.LogVal('Snapshot count', state.SnapShotsMany.CurrentSnapShots.length);
            }
        }
    }
    PromiseBucketDebug(promiseBucket, friendlyName) {
        this.FuncStart(this.PromiseBucketDebug.name, friendlyName);
        this.Log('promiseBucket : ' + this.IsNullOrUndefined(promiseBucket));
        if (promiseBucket && typeof (promiseBucket) !== 'undefined') {
            this.Log('promiseBucket.IFramesbefore: ' + this.IsNullOrUndefined(promiseBucket.IFramesbefore));
            this.Log('promiseBucket.oneCEdata: ' + this.IsNullOrUndefined(promiseBucket.oneCEdata));
            this.Log('promiseBucket.NewIframe: ' + this.IsNullOrUndefined(promiseBucket.NewIframe));
            if (promiseBucket.NewIframe) {
                this.DebugDataOneIframe(promiseBucket.NewIframe);
            }
        }
        this.FuncEnd(this.PromiseBucketDebug.name, friendlyName);
    }
    __triggerAllDebugTextChangedCallbacks(data) {
        for (var idx = 0; idx < this.__debugTextChangedCallbacks.length; idx++) {
            var oneCallback = this.__debugTextChangedCallbacks[idx];
            oneCallback.Func(oneCallback.Caller, data);
        }
    }
    CtorName(ctorName) {
        this.Log('Constructor: ' + ctorName);
    }
    FuncStart(textOrFunc, optionalValue) {
        textOrFunc = 's' + ' ' + this.__callDepth + ') ' + textOrFunc;
        if (!optionalValue) {
            optionalValue = '';
        }
        else {
            optionalValue = optionalValue.toString();
        }
        if (optionalValue.length > 0) {
            textOrFunc = textOrFunc + ' : ' + optionalValue;
        }
        this.Log(textOrFunc, '', true);
        this.__callDepth++;
        if (this.__callDepth > 10) {
            this.__callDepth = 10;
        }
    }
    FuncEnd(text, optionalValueInput) {
        this.__callDepth--;
        if (this.__callDepth < 0) {
            this.__callDepth = 0;
        }
        text = 'e' + ' ' + this.__callDepth + ') ' + text;
        if (!optionalValueInput) {
            optionalValueInput = '';
        }
        var optionalValue = optionalValueInput.toString();
        if (optionalValue.length > 0) {
            text = text + ' : ' + optionalValue;
        }
        this.Log(text, optionalValue, true);
    }
    Error(container, text) {
        if (!container) {
            container = 'unknown';
        }
        if (!text) {
            text = 'unknown';
        }
        this.ErrorStack.push({
            ContainerFunc: container,
            ErrorString: text
        });
        this.Log('');
        this.Log('\t\t** ERROR ** ' + container);
        this.Log('');
        this.Log('\t\t  ' + text);
        this.Log('');
        this.Log('\t\t** ERROR ** ' + container);
        this.Log('');
    }
    NotNullCheck(title, value) {
        if (typeof value === 'undefined') {
            this.LogVal(title, 'Is Undefined');
        }
        else if (!value) {
            this.LogVal(title, 'Is Null');
        }
        else {
            this.LogVal(title, 'Is Not Null');
        }
    }
    IsNullOrUndefined(subject) {
        var toReturn = '{unknown}';
        if (subject) {
            if ((typeof subject) === 'undefined') {
                toReturn = 'Is Undefined';
            }
            else {
                toReturn = 'Not Null';
            }
        }
        else {
            toReturn = 'Is Null';
        }
        return toReturn;
    }
}

// CONCATENATED MODULE: ./AutoBuild/TsTranspiled/Content/scripts/zLast.js





var zLast_allContentAgents = new ContentAgents();
zLast_allContentAgents.Logger = new LoggerAgentBase_LoggerAgent();
zLast_allContentAgents.SettingsAgent = new SettingsAgent();
zLast_allContentAgents.HelperAgents = new AllHelperAgents(zLast_allContentAgents.Logger, zLast_allContentAgents.SettingsAgent);
new ContentHub_ContentHub(zLast_allContentAgents);


/***/ })
/******/ ]);